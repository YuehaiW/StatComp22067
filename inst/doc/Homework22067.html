<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="22067" />

<meta name="date" content="2022-12-08" />

<title>Homework22067</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>
<script>$(document).ready(function(){
    if (typeof $('[data-toggle="tooltip"]').tooltip === 'function') {
        $('[data-toggle="tooltip"]').tooltip();
    }
    if ($('[data-toggle="popover"]').popover === 'function') {
        $('[data-toggle="popover"]').popover();
    }
});
</script>
<style type="text/css">
.lightable-minimal {
border-collapse: separate;
border-spacing: 16px 1px;
width: 100%;
margin-bottom: 10px;
}
.lightable-minimal td {
margin-left: 5px;
margin-right: 5px;
}
.lightable-minimal th {
margin-left: 5px;
margin-right: 5px;
}
.lightable-minimal thead tr:last-child th {
border-bottom: 2px solid #00000050;
empty-cells: hide;
}
.lightable-minimal tbody tr:first-child td {
padding-top: 0.5em;
}
.lightable-minimal.lightable-hover tbody tr:hover {
background-color: #f5f5f5;
}
.lightable-minimal.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-classic {
border-top: 0.16em solid #111111;
border-bottom: 0.16em solid #111111;
width: 100%;
margin-bottom: 10px;
margin: 10px 5px;
}
.lightable-classic tfoot tr td {
border: 0;
}
.lightable-classic tfoot tr:first-child td {
border-top: 0.14em solid #111111;
}
.lightable-classic caption {
color: #222222;
}
.lightable-classic td {
padding-left: 5px;
padding-right: 5px;
color: #222222;
}
.lightable-classic th {
padding-left: 5px;
padding-right: 5px;
font-weight: normal;
color: #222222;
}
.lightable-classic thead tr:last-child th {
border-bottom: 0.10em solid #111111;
}
.lightable-classic.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-classic.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-classic-2 {
border-top: 3px double #111111;
border-bottom: 3px double #111111;
width: 100%;
margin-bottom: 10px;
}
.lightable-classic-2 tfoot tr td {
border: 0;
}
.lightable-classic-2 tfoot tr:first-child td {
border-top: 3px double #111111;
}
.lightable-classic-2 caption {
color: #222222;
}
.lightable-classic-2 td {
padding-left: 5px;
padding-right: 5px;
color: #222222;
}
.lightable-classic-2 th {
padding-left: 5px;
padding-right: 5px;
font-weight: normal;
color: #222222;
}
.lightable-classic-2 tbody tr:last-child td {
border-bottom: 3px double #111111;
}
.lightable-classic-2 thead tr:last-child th {
border-bottom: 1px solid #111111;
}
.lightable-classic-2.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-classic-2.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-material {
min-width: 100%;
white-space: nowrap;
table-layout: fixed;
font-family: Roboto, sans-serif;
border: 1px solid #EEE;
border-collapse: collapse;
margin-bottom: 10px;
}
.lightable-material tfoot tr td {
border: 0;
}
.lightable-material tfoot tr:first-child td {
border-top: 1px solid #EEE;
}
.lightable-material th {
height: 56px;
padding-left: 16px;
padding-right: 16px;
}
.lightable-material td {
height: 52px;
padding-left: 16px;
padding-right: 16px;
border-top: 1px solid #eeeeee;
}
.lightable-material.lightable-hover tbody tr:hover {
background-color: #f5f5f5;
}
.lightable-material.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-material.lightable-striped tbody td {
border: 0;
}
.lightable-material.lightable-striped thead tr:last-child th {
border-bottom: 1px solid #ddd;
}
.lightable-material-dark {
min-width: 100%;
white-space: nowrap;
table-layout: fixed;
font-family: Roboto, sans-serif;
border: 1px solid #FFFFFF12;
border-collapse: collapse;
margin-bottom: 10px;
background-color: #363640;
}
.lightable-material-dark tfoot tr td {
border: 0;
}
.lightable-material-dark tfoot tr:first-child td {
border-top: 1px solid #FFFFFF12;
}
.lightable-material-dark th {
height: 56px;
padding-left: 16px;
padding-right: 16px;
color: #FFFFFF60;
}
.lightable-material-dark td {
height: 52px;
padding-left: 16px;
padding-right: 16px;
color: #FFFFFF;
border-top: 1px solid #FFFFFF12;
}
.lightable-material-dark.lightable-hover tbody tr:hover {
background-color: #FFFFFF12;
}
.lightable-material-dark.lightable-striped tbody tr:nth-child(even) {
background-color: #FFFFFF12;
}
.lightable-material-dark.lightable-striped tbody td {
border: 0;
}
.lightable-material-dark.lightable-striped thead tr:last-child th {
border-bottom: 1px solid #FFFFFF12;
}
.lightable-paper {
width: 100%;
margin-bottom: 10px;
color: #444;
}
.lightable-paper tfoot tr td {
border: 0;
}
.lightable-paper tfoot tr:first-child td {
border-top: 1px solid #00000020;
}
.lightable-paper thead tr:last-child th {
color: #666;
vertical-align: bottom;
border-bottom: 1px solid #00000020;
line-height: 1.15em;
padding: 10px 5px;
}
.lightable-paper td {
vertical-align: middle;
border-bottom: 1px solid #00000010;
line-height: 1.15em;
padding: 7px 5px;
}
.lightable-paper.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-paper.lightable-striped tbody tr:nth-child(even) {
background-color: #00000008;
}
.lightable-paper.lightable-striped tbody td {
border: 0;
}
</style>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework22067</h1>
<h4 class="author">22067</h4>
<h4 class="date">2022-12-08</h4>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(StatComp22067)</span></code></pre></div>
<div id="hw0" class="section level2">
<h2>HW0</h2>
<div id="question" class="section level3">
<h3>Question</h3>
<p>Use knitr to produce at least 3 examples(texts,figures,tables).</p>
</div>
<div id="answer" class="section level3">
<h3>Answer</h3>
<div id="figure" class="section level4">
<h4>Figure</h4>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#散点图</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">50</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">runif</span>(n, <span class="at">min=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">max=</span><span class="dv">2</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">type=</span><span class="st">&quot;p&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="table" class="section level4">
<h4>Table</h4>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#用表格展示R中mtcars数据集</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(mtcars),<span class="at">align=</span><span class="st">&quot;c&quot;</span>)</span></code></pre></div>
<table>
<colgroup>
<col width="22%" />
<col width="7%" />
<col width="6%" />
<col width="7%" />
<col width="6%" />
<col width="7%" />
<col width="8%" />
<col width="8%" />
<col width="5%" />
<col width="5%" />
<col width="7%" />
<col width="7%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">mpg</th>
<th align="center">cyl</th>
<th align="center">disp</th>
<th align="center">hp</th>
<th align="center">drat</th>
<th align="center">wt</th>
<th align="center">qsec</th>
<th align="center">vs</th>
<th align="center">am</th>
<th align="center">gear</th>
<th align="center">carb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Mazda RX4</td>
<td align="center">21.0</td>
<td align="center">6</td>
<td align="center">160</td>
<td align="center">110</td>
<td align="center">3.90</td>
<td align="center">2.620</td>
<td align="center">16.46</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">4</td>
<td align="center">4</td>
</tr>
<tr class="even">
<td align="left">Mazda RX4 Wag</td>
<td align="center">21.0</td>
<td align="center">6</td>
<td align="center">160</td>
<td align="center">110</td>
<td align="center">3.90</td>
<td align="center">2.875</td>
<td align="center">17.02</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">4</td>
<td align="center">4</td>
</tr>
<tr class="odd">
<td align="left">Datsun 710</td>
<td align="center">22.8</td>
<td align="center">4</td>
<td align="center">108</td>
<td align="center">93</td>
<td align="center">3.85</td>
<td align="center">2.320</td>
<td align="center">18.61</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">4</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="left">Hornet 4 Drive</td>
<td align="center">21.4</td>
<td align="center">6</td>
<td align="center">258</td>
<td align="center">110</td>
<td align="center">3.08</td>
<td align="center">3.215</td>
<td align="center">19.44</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">3</td>
<td align="center">1</td>
</tr>
<tr class="odd">
<td align="left">Hornet Sportabout</td>
<td align="center">18.7</td>
<td align="center">8</td>
<td align="center">360</td>
<td align="center">175</td>
<td align="center">3.15</td>
<td align="center">3.440</td>
<td align="center">17.02</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">3</td>
<td align="center">2</td>
</tr>
<tr class="even">
<td align="left">Valiant</td>
<td align="center">18.1</td>
<td align="center">6</td>
<td align="center">225</td>
<td align="center">105</td>
<td align="center">2.76</td>
<td align="center">3.460</td>
<td align="center">20.22</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">3</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
</div>
<div id="text" class="section level4">
<h4>Text</h4>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#取出数据框的列名即为字符串</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mtcars)</span></code></pre></div>
<pre><code>##  [1] &quot;mpg&quot;  &quot;cyl&quot;  &quot;disp&quot; &quot;hp&quot;   &quot;drat&quot; &quot;wt&quot;   &quot;qsec&quot; &quot;vs&quot;   &quot;am&quot;   &quot;gear&quot;
## [11] &quot;carb&quot;</code></pre>
<p>还可以用LaTeX打公式，如梯度下降公式： <span class="math display">\[\theta\quad\leftarrow\quad\theta-\alpha\nabla_{\theta}L(\theta)\]</span></p>
</div>
</div>
</div>
<div id="hw1" class="section level2">
<h2>HW1</h2>
</div>
<div id="question-1" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p>The Pareto(a, b) distribution has cdf <span class="math display">\[F(x)=1-(\frac{b}{x})^a,\quad x\geq
b&gt;0,a&gt;0.\]</span> Derive the probability inverse transformation
<span class="math inline">\(F^{-1}(U)\)</span> and use the inverse
transform method to simulate a random sample from the Pareto(2, 2)
distribution. Graph the density histogram of the sample with the
Pareto(2, 2) density superimposed for comparison.</p></li>
<li><p>Write a function to generate a random sample of size n from the
Beta(a, b) distribution by the acceptance-rejection method. Generate a
random sample of size 1000 from the Beta(3,2) distribution. Graph the
histogram of the sample with the theoretical Beta(3,2) density
superimposed.</p></li>
<li><p>Simulate a continuous Exponential-Gamma mixture. Suppose that the
rate parameter <span class="math inline">\(\Lambda\)</span> has
Gamma(<span class="math inline">\(r, \beta\)</span>) distribution and Y
has Exp(Λ) distribution.That is, <span class="math inline">\((Y |Λ = λ)
∼ f_Y (y|λ) = λe^{−λy}\)</span>. Generate 1000 random observations from
this mixture with <span class="math inline">\(r = 4\)</span> and <span class="math inline">\(\beta = 2\)</span>.</p></li>
</ol>
<p>4.It can be shown that the mixture in Question3 has a Pareto
distribution with cdf<span class="math display">\[F(y)=1-(\frac{\beta}{\beta+y})^r,\quad
y\geq0.\]</span> (This is an alternative parameterization of the Pareto
cdf given in Question1.) Generate 1000 random observations from the
mixture with <span class="math inline">\(r = 4\)</span> and <span class="math inline">\(\beta = 2\)</span>. Compare the empirical and
theoretical(Pareto)distributions by graphing the density histogram of
the sample and superimposing the Pareto density curve.</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<div id="question-1-1" class="section level3">
<h3>Question 1</h3>
<p>We have <span class="math inline">\(F^{-1}(u)=\frac{b}{\sqrt[a]{1-u}}\)</span> and
<span class="math inline">\(f(x)=F&#39;(x)=\frac{ab^a}{x^{a+1}}\)</span>
.</p>
<p>Below is the histogram and density curve.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>u <span class="ot">=</span> <span class="fu">runif</span>(n)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> b<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>u)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span>a)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">probability=</span><span class="cn">TRUE</span>, <span class="at">main=</span><span class="st">&quot;f(x)&quot;</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">80</span>, <span class="fl">0.5</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y, a<span class="sc">*</span>b<span class="sc">^</span>a<span class="sc">/</span>y<span class="sc">^</span>(a<span class="sc">+</span><span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Notice that when <span class="math inline">\(u=0.99,F^{-1}(u)=20\)</span>, so there is large
probability that <span class="math inline">\(F^{-1}(u)\)</span> will
stack in <span class="math inline">\((0,20)\)</span>. The histogram
matches the density curve.</p>
</div>
<div id="question-2" class="section level3">
<h3>Question 2</h3>
<p>If <span class="math inline">\(a,b&lt;1\)</span>, <span class="math inline">\(f(x)\)</span> may approach <span class="math inline">\(\infty\)</span> when <span class="math inline">\(x\rightarrow0\quad or\quad x\rightarrow1\)</span>,
so we’d better suppose that <span class="math inline">\(a,b\geq1\)</span>. Besides, we suppose that <span class="math inline">\(a,b\)</span> are integers for convenient. We can
use optimize() to calculate maximum value of <span class="math inline">\(f(x)\)</span> and use density function of uniform
distribution to comply acceptance-rejection algorithm. Let <span class="math inline">\(g(x)=1,0&lt;x&lt;1\)</span> and <span class="math inline">\(c=x0+0.5\)</span>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>gamma <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">factorial</span>(x<span class="dv">-1</span>))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>rbeta_ar <span class="ot">&lt;-</span> <span class="cf">function</span>(n, a, b){</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">=</span> <span class="fu">numeric</span>(n) </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#density function of Beta(a,b)</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  fbeta <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">gamma</span>(a<span class="sc">+</span>b)<span class="sc">/</span><span class="fu">gamma</span>(a)<span class="sc">/</span><span class="fu">gamma</span>(b)<span class="sc">*</span>x<span class="sc">^</span>(a<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span>(b<span class="dv">-1</span>))</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  x0 <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">optimize</span>(fbeta,<span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> <span class="dv">1</span>, <span class="at">maximum =</span> <span class="cn">TRUE</span>)[[<span class="dv">1</span>]])</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(k <span class="sc">&lt;</span> n){</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    u <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>((<span class="fu">fbeta</span>(x)<span class="sc">/</span>(<span class="fu">fbeta</span>(x0)<span class="sc">+</span><span class="fl">0.5</span>)) <span class="sc">&gt;</span> u){</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>      k <span class="ot">=</span> k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>      y[k] <span class="ot">=</span> x</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">234</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rbeta_ar</span>(n, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.01</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">&quot;Beta(3,2)&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>))</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y, <span class="fu">dbeta</span>(y, <span class="dv">3</span>, <span class="dv">2</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-3" class="section level3">
<h3>Question 3</h3>
<p>We can first generate n observations from Gamma distribution and then
use them to generate Exp distribution.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">345</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>r <span class="ot">=</span> <span class="dv">4</span> </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">=</span> <span class="fu">rgamma</span>(n, r, beta)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rexp</span>(n, lambda)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">main=</span><span class="st">&quot;Exponential-Gamma mixture&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-4" class="section level3">
<h3>Question 4</h3>
<p>We can calculate <span class="math inline">\(F&#39;(y)=\frac{r\beta^r}{(\beta
+y)^{r+1}}.\)</span></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>r <span class="ot">=</span> <span class="dv">4</span> </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">=</span> <span class="fu">rgamma</span>(n, r, beta)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rexp</span>(n, lambda)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">0.1</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">main=</span><span class="st">&quot;Exponential-Gamma mixture&quot;</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y, r<span class="sc">*</span>beta<span class="sc">^</span>r<span class="sc">/</span>(beta<span class="sc">+</span>y)<span class="sc">^</span>(r<span class="sc">+</span><span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="hw2" class="section level2">
<h2>HW2</h2>
<hr />
</div>
<div id="question-on-ppt" class="section level2">
<h2>Question on PPT</h2>
<ul>
<li>For <span class="math inline">\(n=10^4,2\times10^4,4\times10^4,6\times10^4,8\times10^4\)</span>,
apply the fast sorting algorithm to randomly permuted numbers of <span class="math inline">\(1,\ldots,n\)</span>.</li>
<li>Calculate computation time averaged over 100 simulations, denoted by
<span class="math inline">\(a_n\)</span>.</li>
<li>Regress <span class="math inline">\(a_n\)</span> on <span class="math inline">\(t_n:=n\log(n)\)</span>, and graphically show the
results (scatter plot and regression line).</li>
</ul>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define a quicksort funciton</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>quicksort <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  num <span class="ot">=</span> <span class="fu">length</span>(x)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(num <span class="sc">&lt;</span> <span class="dv">2</span>){<span class="fu">return</span>(x)}</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    z <span class="ot">=</span> x[<span class="dv">1</span>] <span class="co">#In Step 1, pick x[1] to compare</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">=</span> x[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    lower <span class="ot">=</span> y[y<span class="sc">&lt;</span>z]</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    upper <span class="ot">=</span> y[y<span class="sc">&gt;=</span>z]</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">quicksort</span>(lower),z,<span class="fu">quicksort</span>(upper)))</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co"># define a function to compute time over 100 simulations</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>avgtime <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  t <span class="ot">=</span> <span class="fu">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>    t[i] <span class="ot">=</span> <span class="fu">system.time</span>(<span class="fu">quicksort</span>(x))[<span class="dv">1</span>]</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(t))</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>t <span class="ot">=</span> <span class="fu">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">1e4</span>, <span class="dv">2</span><span class="sc">*</span><span class="fl">1e4</span>, <span class="dv">4</span><span class="sc">*</span><span class="fl">1e4</span>, <span class="dv">6</span><span class="sc">*</span><span class="fl">1e4</span>, <span class="dv">8</span><span class="sc">*</span><span class="fl">1e4</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  a[i] <span class="ot">=</span> <span class="fu">avgtime</span>(n[i])</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  t[i] <span class="ot">=</span> n[i]<span class="sc">*</span><span class="fu">log</span>(n[i])</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">lm</span>(a<span class="sc">~</span>t)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = a ~ t)
## 
## Residuals:
##          1          2          3          4          5 
## -0.0006732 -0.0007202  0.0011144  0.0021382 -0.0018592 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 2.098e-03  1.512e-03   1.387    0.259    
## t           1.061e-07  2.780e-09  38.173 3.95e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.001848 on 3 degrees of freedom
## Multiple R-squared:  0.9979, Adjusted R-squared:  0.9973 
## F-statistic:  1457 on 1 and 3 DF,  p-value: 3.955e-05</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t,a,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">xlab=</span><span class="st">&quot;nlog(n)&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;time&quot;</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(fit<span class="sc">$</span>coef[[<span class="dv">1</span>]],fit<span class="sc">$</span>coef[[<span class="dv">2</span>]],<span class="at">col=</span><span class="st">&quot;cyan&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercise-5.6" class="section level2">
<h2>Exercise 5.6</h2>
<p>In Example 5.7 the control variate approach was illustrated for Monte
Carlo integration of <span class="math display">\[\theta=\int_{0}^{1}e^xdx.\]</span> Now consider
the antithetic variate approach. Compute <span class="math inline">\(Cov(e^U,e^{1−U})\)</span> and <span class="math inline">\(Var(e^U+e^{1−U})\)</span>, where <span class="math inline">\(U ∼ Uniform(0,1).\)</span> What is the percent
reduction in variance of <span class="math inline">\(\hat\theta\)</span>
that can be achieved using antithetic variates (compared with simple
MC)?</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<p><span class="math display">\[\begin{aligned}
Cov(e^U,e^{1−U})
&amp; = E(e^Ue^{1-U})-E(e^U)E(e^{1-U})\\
&amp; = e-(e-1)^2\\
&amp; = -e^2+3e-1, \\
Var(e^U+e^{1−U})
&amp; = Cov(e^U+e^{1−U},e^U+e^{1−U})\\
&amp; = Var(e^U)+2Cov(e^U,e^{1−U})+Var(e^{1-U})\\
&amp; = \frac{e^2-1}{2}-(e-1)^2+2(-e^2+3e-1)+\frac{e^2-1}{2}-(e-1)^2\\
&amp; = -3e^2+10e-5.
\end{aligned}\]</span></p>
<p>For the simple estimator,<span class="math inline">\(Var(\hat\theta)=\frac{Var(e^U)}{m}\)</span>.<br />
For the antithetic variable estimator,<span class="math inline">\(Var(\hat\theta&#39;)=\frac{Var(e^U+e^{1−U})}{2m}\)</span>.<br />
Then, the percent reduction in variance is <span class="math display">\[100(1-\frac{Var(e^U+e^{1−U})}{2Var(e^U)})=100(1-\frac{-3e^2+10e-5}{-e^2+4e-3})
\approx96.767\%.\]</span></p>
</div>
<div id="exercise-5.7" class="section level2">
<h2>Exercise 5.7</h2>
<p>Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate <span class="math inline">\(\theta\)</span> by the antithetic variate approach
and by the simple Monte Carlo method. Compute an empirical estimate of
the percent reduction in variance using the antithetic variate. Compare
the result with the theoretical value from Exercise 5.6.</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<p>The simple Monte Carlo method:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>MC_anti <span class="ot">&lt;-</span> <span class="cf">function</span>(n, <span class="at">anti=</span><span class="cn">FALSE</span>){</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">=</span> <span class="fu">runif</span>(n<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(anti) {</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    v <span class="ot">=</span> <span class="dv">1</span><span class="sc">-</span>u</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>((<span class="fu">mean</span>(<span class="fu">exp</span>(u))<span class="sc">+</span><span class="fu">mean</span>(<span class="fu">exp</span>(v)))<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> {</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    v <span class="ot">=</span> <span class="fu">runif</span>(n<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    u <span class="ot">=</span> <span class="fu">c</span>(u,v)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">mean</span>(<span class="fu">exp</span>(u)))</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="fl">1e4</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>v1 <span class="ot">&lt;-</span> v2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">1000</span>)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a> v1[i] <span class="ot">=</span> <span class="fu">MC_anti</span>(m)</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a> v2[i] <span class="ot">=</span> <span class="fu">MC_anti</span>(m,<span class="cn">TRUE</span>)</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>var1 <span class="ot">=</span> <span class="fu">var</span>(v1)</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>var2 <span class="ot">=</span> <span class="fu">var</span>(v2)</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(var1, var2, (var1<span class="sc">-</span>var2)<span class="sc">/</span>var1)</span></code></pre></div>
<pre><code>## [1] 2.423449e-05 7.465305e-07 9.691955e-01</code></pre>
<p>The antithetic variate approach:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>u <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>v <span class="ot">=</span> <span class="dv">1</span><span class="sc">-</span>u</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">c</span>(u,v))</span></code></pre></div>
<pre><code>## [1]  2.7182818  7.3890561 20.0855369  1.0000000  0.3678794  0.1353353</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">exp</span>(<span class="fu">c</span>(u,v)))</span></code></pre></div>
<pre><code>## [1] 5.282682</code></pre>
<p>From the result, we can see the value roughly equals the theoretical
value from Exercise 5.6.</p>
</div>
<div id="hw3" class="section level2">
<h2>HW3</h2>
</div>
<div id="exercise-5.13" class="section level2">
<h2>Exercise 5.13</h2>
<p><strong>Problem</strong><br />
</p>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on (1, ∞) and are
‘close’ to <span class="math display">\[g(x) = \frac{x^2}{\sqrt{2\pi}}
e^{−x^2/2},\quad x&gt; 1.\]</span> Which of your two importance
functions should produce the smaller variance in estimating <span class="math display">\[\theta=\int_{1}^{\infty}
\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\]</span> by importance sampling?
Explain.</p>
<p><strong>Answer</strong><br />
</p>
<p>It’s oblivious that <span class="math inline">\(g(x)\)</span> is
close to density of standard normal distribution, so we can set <span class="math display">\[f_1(x)=\frac{1}{\sqrt{2\pi}} e^{−x^2/2}.\]</span>
Then we can use density of Gamma distribution as <span class="math inline">\(f_2\)</span>. The density function of <span class="math inline">\(Gamma(3,2)\)</span> is <span class="math display">\[f_2(x)=\frac{1}{16}x^2e^{-x/2}I_{(0,\infty)}(x).\]</span></p>
<ul>
<li>Here is two figures about <span class="math inline">\(g, f_1,
f_2\)</span>.</li>
</ul>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span>(x<span class="sc">&gt;=</span><span class="dv">1</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">8</span>,<span class="fl">0.01</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>gs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">g</span>(x)),<span class="fu">expression</span>(<span class="fu">f1</span>(x)),<span class="fu">expression</span>(<span class="fu">f2</span>(x)))</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># figure of g, f1, f2</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="fu">g</span>(x), <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.6</span>), <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col=</span><span class="dv">1</span>)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="fu">dnorm</span>(x), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="fu">dgamma</span>(x,<span class="dv">3</span>,<span class="dv">2</span>), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> gs, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">inset =</span> <span class="fl">0.02</span>,<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co"># figure of g/f1, g/f2</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">dnorm</span>(x), <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>), <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">dgamma</span>(x,<span class="dv">3</span>,<span class="dv">2</span>), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> gs[<span class="sc">-</span><span class="dv">1</span>], <span class="at">lty=</span><span class="dv">1</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">inset =</span> <span class="fl">0.02</span>,<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAeFBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6OmY6OpA6kNth0E9mAABmADpmOmZmZmZmZpBmkLZmtv+QOgCQZmaQkLaQ2/+2ZgC2kJC22/+2/7a2///bkDrb2//b/9vb///fU2v/tmb/25D/27b//7b//9v///+wOB8CAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHi0lEQVR4nO2diXLbNhRFWdd2F0upW6uN2oRNRFX0//9hCYLaKEAXJJb3PLxnJqkm7gB3jkAQeFxcvZO7VNIBtENBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCDANEHbh6/v++eq+uFzpjj6mCSo9/NTJ+ewfssVSBtTBB3WL52kJ/OxfvyeKZA2pgl6e283L+Zj042lZTDtEOtGT80R5OewfvjaD6FmObP0xNN8U/U8eZvzEht0HvF5Egf3NiclqPuz23l+ENxCQjiCBuqpZzFtK/bCIwh/L2UFJcxTKvjCR5CefkLJJKjd2JE7fR29DEF19WI/NMcPwSxC0LAPM0zeaixC0EWRY/JmdRGCOIIQdTUMIc5BHg5rexabXuxYiKBA/vvjRqCQoPbv41w5yiS8UDy8judwIUG/n61cZ5JeSe9/HY0hIUGXTq4ySQsaavv5+5nCZSZxQeOirAZBl5mkBHXrx/7i0PB3tn4mUDszSQnqlpJ2DdluHuedNZLTOjNJCWoevnz6bGNdb0YEDzFnJrGK4na44tFuriehnIL2z/cvhLsyiU3SzbAbKSHouK5HFSpXJilB7ebVRi1yiA1bQjCCnJmkBNWP3+yWv8wkfVibXm4FXRXtnZmkBK3fhlJRqdP8tjtq7o+ggzOTlKDuK2o3ZkostlCsq5f7grbOTOIr6XJbjf3zj+AsdkTTVmP/y+iskvE0324qr6DLYXyVSVhQ+6eScsdv5xzXmYQLZn/pKZj9M3waZZI+xMT6CUVsoRhd4kyLupJrfIkzLepKrvElzrToLbkaZq07MqJpHdQza+WaESUr6cgSp7Y8qQtm0SXO5OgquRriSpza8uQIHlXizICqkqshqsSZAU0lV5sjpsSpLU+G4HElTm150gePLHFqyzMjeHP/mdXIEmcSLpcdRUuu26p6MVuasGdWl7fVMF/Gtv8afDdxxpc401K25NqPm/6pZ+9twPElzrSULbnaSa79990/guJLnGkpXHI9PSU2viyYuJ8CZJqka3seaPzXWdL0kx/WpAGsSQNyC/I9s6qtJu1FsGB2RttC8RLWpAGsSQMyCQp5ZlVbTdpNpoVi0DOrmmrSZd+8EPrEoaKadOV+c0fOzarl7jOrimrSZQUFjqCCNem6O1b6L8O3LisrKPCZ1XI1abM1PKzN8axEUNAzq+Vq0nZE91+DFkEhlKtJH+fErseRoPPJaqdP0JncW43TnLh98o4gjx8xQWVr0kct3ZH/UQQVrknXpwXFRxGkrSatTpB4P+NuKQh0q0SQtpe8nbtVIkhPP+NuKQh0S0GgWwoC3VIQ6FaboPgSZ+I86gR1garVKns/oWgUtKOge81ZQbeGKOjYnOcYo6Bjc9oE+X4Q3EKiJKfmKAg0R0GgORWCLor2vv8juKlEkU7NqRCEu6Ug0K1Uwewo6MbQwgVdNGdWio4hJCnIsbCnoHO3K9fCXlCQZxISE7SioHsYQe9Re8NcgsaRpAStKOgudiyXEwTvch0E3R5jQoJWg6D5h/zEO8zQXa69INdpTEyQ/buMoIB7FE1zVtDq9gcCDN1GHPJTggfc5WoFOSahRQgKHkGOSUh4q1FGUMBdrlaQ4xgTFzT3C5sWHN7leiloNf6BAKUFhTXnGkJ5BIUsOyyzR3Q2QaMxlEVQ0LLDMntEzwzuv3HbsDOsrsghKPCkYVnNzJO8YNazu1GUQ5B/2eG6JUBUEG5OfATNzfORBQUuO+LypN+spugnlKBlR1ye9JvVBP2ko6ygkGNe2w1U0XkSb1ZNe9XpP9efRIjOk3gELVtQyCOZyxYU8EjmwgUVCKQtDwXhBnQF0paHgnADugJpyyOW/KNAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCAIkF7X92XO04ve2wPPF50go6rB2Xg8zbDme8BT8FCfIkFdS4LkrbVwaOfzl2EVLkSSmoqV4cFxTlBCXJk3gOcl1xFTzEEuQpIAj9OqmcxOcpIGjb/dv+eeqvcklDfJ78gvbPZjT7bmrMTHye/ILsK28bmYMsPk+pEXT3Feb5iM/DOQhQ4iy27Zb2Mn4S5OFmFUBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBMglyNzidvn75qWZnSeXIPOuIe9LhgSYnSfbIdY8fPkkdO+vk7l58s1B20ri6QM/M/PkEyR1c72PmXmyCWo3rzI3tnqYmyeboPrx20bPSWx+nlyCzCsFhe6NdjI7Ty5B2+6Uah880sHsPFxJAygIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIMD/5OhlcMtv/WYAAAAASUVORK5CYII=" /><!-- --></p>
<p>From the figure, we can guess that <span class="math inline">\(f_2\)</span> may produce a smaller variance when
estiamting since <span class="math inline">\(g/f_2\)</span> is closer to
a constant compared to <span class="math inline">\(g/f_1\)</span> which
is a quadratic function. Besides, <span class="math inline">\(f_1\)</span> have larger ranges and many of the
simulated values will contribute zeros to the sum, which is
inefficient.</p>
<ul>
<li>Here is a simulation:</li>
</ul>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="fl">1e4</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> se <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># using f1</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m) </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> <span class="fu">dnorm</span>(x)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>se[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co"># using f2</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(m,<span class="dv">3</span>,<span class="dv">2</span>) </span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> <span class="fu">dgamma</span>(x,<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>se[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(theta, se)</span></code></pre></div>
<pre><code>##            [,1]      [,2]
## theta 0.4026291 0.4037075
## se    1.1138778 0.3027751</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>se<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] 1.24072375 0.09167277</code></pre>
<p>From the simulation we can confirm that <span class="math inline">\(f_2\)</span> is better at estimating <span class="math inline">\(\theta\)</span>.</p>
</div>
<div id="exercise-5.15" class="section level2">
<h2>Exercise 5.15</h2>
<p><strong>Problem</strong><br />
</p>
<p>Obtain the stratified importance sampling estimate in Example 5.13
and compare it with the result of Example 5.10.</p>
<p><strong>Answer</strong></p>
<ul>
<li>Example 5.10</li>
</ul>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>est1 <span class="ot">&lt;-</span> sd1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="sc">-</span>x <span class="sc">-</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> (x <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">*</span> (x <span class="sc">&lt;</span> <span class="dv">1</span>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m) <span class="co">#f3, inverse transform method</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="sc">-</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> u <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> (<span class="fu">exp</span>(<span class="sc">-</span>x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>est1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>sd1 <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg)</span></code></pre></div>
<ul>
<li>Example 5.13</li>
</ul>
<p>Let <span class="math inline">\(f(x)=\frac{e^{-x}}{1-e^{-1}}\)</span>, <span class="math inline">\(F(x)=\int f(x)=\frac{1-e^{-x}}{1-e^{-1}}\)</span>.
Then <span class="math inline">\(F^{-1}(x)=-log[1-(1-e^{-1})x)]\)</span>. We divide
the real line into <span class="math inline">\(k=5\)</span> intervals
<span class="math inline">\(I_j=\{x:a_{j-1}\leq x&lt;a_j\}\)</span> and
<span class="math inline">\(a_j=F^{-1}(\frac{j}{k}),j=1,\dots,k\)</span>. On
each subinterval, the conditional density <span class="math inline">\(f_j\)</span> of <span class="math inline">\(X\)</span> is <span class="math display">\[f_j(x)=f_{X|I_j}(x|I_j)=\frac{f(x,a_{j-1}\leq
x&lt;a_j)}{P(a_{j-1}\leq x&lt;a_j)}=kf(x),\quad a_{j-1}\leq
x&lt;a_j.\]</span></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">5</span> </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> M<span class="sc">/</span>k <span class="co"># replicates per stratum</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>T1 <span class="ot">&lt;-</span> T2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>est2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>fj <span class="ot">&lt;-</span> <span class="cf">function</span>(x)<span class="dv">5</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)) <span class="co"># fj(x)</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x)<span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<p>For each subinterval <span class="math inline">\(I_j\)</span>, we use
inverse transform method to generate samples from <span class="math inline">\(f_j(x)\)</span>. Since <span class="math display">\[\begin{aligned}
F_j(x)
&amp;=\int_{a_{j-1}}^{x}f_j(x)dx\\
&amp;=5F(x)-5F(a_{j-1})\\
&amp;=5(F(x)-j+1),
\end{aligned}\]</span> we have <span class="math inline">\(F^{-1}_j(x)=-log[1-(1-e^{-1})(x+j-1)]\)</span>.<br />
Let <span class="math inline">\(\sigma_j^2=Var(g_j(X)/f_j(X))\)</span>.
For each <span class="math inline">\(j = 1,...,k\)</span>, we simulate
an importance sample size <span class="math inline">\(m\)</span>,
compute the importance sampling estimator <span class="math inline">\(\hat\theta_j\)</span> of <span class="math inline">\(\theta_j\)</span> on the <span class="math inline">\(j^{th}\)</span> subinterval, and compute <span class="math inline">\(\displaystyle\hat\theta^{SI}=\sum_{j=1}^k{\hat\theta_j}\)</span>.Then
by independence of <span class="math inline">\(\hat\theta_1,...,
\hat\theta_k\)</span>, <span class="math display">\[\displaystyle
Var(\hat\theta^{SI})=Var(\sum_{j=1}^k{\hat\theta_j})=\sum_{j=1}^k{\frac{\sigma_j^2}{m}}=\frac{1}{m}\sum_{j=1}^k{\sigma_j^2}.\]</span></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">=</span> <span class="fu">runif</span>(m)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>(u<span class="sc">+</span>j<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">5</span>) <span class="co"># inverse transform method</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  T1[j] <span class="ot">=</span> <span class="fu">mean</span>(<span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">fj</span>(x))</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  T2[j] <span class="ot">=</span> <span class="fu">var</span>(<span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">fj</span>(x))</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>est2[<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">sum</span>(T1) </span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>est2[<span class="dv">2</span>] <span class="ot">=</span> <span class="fu">sum</span>(T2)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(est1,est2[<span class="dv">1</span>]),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.5248 0.5247</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(sd1,<span class="fu">sqrt</span>(est2[<span class="dv">2</span>])),<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 0.09678 0.00938</code></pre>
<p>From the results, it’s oblivious that the stratified importance
sampling estimate is better because its variance is much smaller than
the result of Example 5.10.</p>
</div>
<div id="hw4" class="section level2">
<h2>HW4</h2>
</div>
<div id="exercise-6.4" class="section level2">
<h2>Exercise 6.4</h2>
<p><strong>Problem</strong><br />
</p>
<p>Suppose that <span class="math inline">\(X_1,...,X_n\)</span> are a
random sample from a lognormal distribution with unknown parameters.
Construct a 95% confidence interval for the parameter <span class="math inline">\(\mu\)</span>. Use a Monte Carlo method to obtain
an empirical estimate of the confidence level.</p>
<p><strong>Answer</strong><br />
</p>
<p>Let <span class="math inline">\(Y_i=logX_i,\ i=1,\dots,n,\)</span>
then <span class="math inline">\(Y_i\sim N(\mu,\sigma^2)\)</span>.Denote
<span class="math display">\[\bar Y=\frac{1}{n}\sum_{i=1}^{n}Y_i,\ \
S^2=\frac{1}{n-1}\sum_{i=1}^n(Y_i-\bar Y)^2.\]</span> Since the
parameters are unknown, we use <span class="math inline">\(T=\frac{\sqrt
n(\bar Y-\mu)}{S}\)</span> to construct a confidence interval. <span class="math inline">\(T\sim t_{n-1}\)</span>, so we can have a <span class="math inline">\(100(1-\alpha)\%\)</span> confidence interval:
<span class="math display">\[[\bar Y-\frac{S}{\sqrt
n}t_{n-1}(\alpha/2),\bar Y+\frac{S}{\sqrt n}t_{n-1}(\alpha/2)].\]</span>
If we replicate for <span class="math inline">\(m\)</span> times and the
<span class="math inline">\(j^{th}\)</span> confidence interval is
defined by <span class="math inline">\([\hat\theta_1^{(j)},\hat\theta_2^{(j)}]\)</span>,
the empirical CP is <span class="math display">\[\frac{1}{m}\sum_{j=1}^m
I(\hat\theta_1^{(j)}\leq\theta\leq\hat\theta_2^{(j)}).\]</span> We can
use <span class="math inline">\(N(0,1)\)</span> to do a simulation.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">1000</span> <span class="co"># number of replicates</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">20</span> <span class="co"># sample size</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fl">0.05</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>t <span class="ot">=</span> <span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>, n<span class="dv">-1</span>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>lci <span class="ot">=</span> uci <span class="ot">=</span> <span class="fu">numeric</span>(m)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>ecp <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  xbar <span class="ot">=</span> <span class="fu">mean</span>(x)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">=</span> <span class="fu">sd</span>(x)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  uci[i] <span class="ot">=</span> xbar<span class="sc">+</span>s<span class="sc">*</span>t<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  lci[i] <span class="ot">=</span> xbar<span class="sc">-</span>s<span class="sc">*</span>t<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(lci[i]<span class="sc">&lt;=</span><span class="dv">0</span> <span class="sc">&amp;</span> <span class="dv">0</span><span class="sc">&lt;=</span>uci[i]){ecp <span class="ot">=</span> ecp<span class="sc">+</span><span class="dv">1</span>}</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>ecp<span class="sc">/</span>m</span></code></pre></div>
<pre><code>## [1] 0.95</code></pre>
<p>From this experiment, an empirical estimate of the confidence level
happens to be 95%. In general, the empirical estimate should be close to
95%.</p>
</div>
<div id="exercise-6.8" class="section level2">
<h2>Exercise 6.8</h2>
<p><strong>Problem</strong><br />
</p>
<p>Refer to Example 6.16. Repeat the simulation, but also compute the
<span class="math inline">\(F\)</span> test of equal variance, at
significance level <span class="math inline">\(\hat\alpha\doteq0.055\)</span>. Compare the power
of the Count Five test and <span class="math inline">\(F\)</span> test
for small, medium, and large sample sizes. (Recall that the <span class="math inline">\(F\)</span> test is not applicable for non-normal
distributions.)</p>
<p><strong>Answer</strong><br />
</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>count5test <span class="ot">&lt;-</span>  <span class="cf">function</span>(x, y) {</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  outx <span class="ot">&lt;-</span> <span class="fu">sum</span>(X <span class="sc">&gt;</span> <span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X <span class="sc">&lt;</span> <span class="fu">min</span>(Y))</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  outy <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y <span class="sc">&gt;</span> <span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y <span class="sc">&lt;</span> <span class="fu">min</span>(X))</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">as.integer</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx, outy)) <span class="sc">&gt;</span> <span class="dv">5</span>))</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">=</span> <span class="fl">1.5</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fl">0.055</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>power5 <span class="ot">=</span> powerF <span class="ot">=</span> <span class="fu">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>repl1 <span class="ot">=</span> repl2 <span class="ot">=</span> <span class="fu">numeric</span>(m) </span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n[i], <span class="dv">0</span>, sigma1)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n[i], <span class="dv">0</span>, sigma2)</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>    repl1[j] <span class="ot">=</span> <span class="fu">count5test</span>(x, y)</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>    repl2[j] <span class="ot">=</span> <span class="fu">var.test</span>(x,y,<span class="at">conf.level=</span>alpha)<span class="sc">$</span>p.value <span class="sc">&lt;=</span> alpha</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>  power5[i] <span class="ot">=</span> <span class="fu">mean</span>(repl1)</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>  powerF[i] <span class="ot">=</span> <span class="fu">mean</span>(repl2)</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(power5,powerF)</span></code></pre></div>
<pre><code>##          [,1]   [,2]   [,3]
## power5 0.1069 0.8491 0.9967
## powerF 0.2100 0.9810 1.0000</code></pre>
<p>From the results, we can see that as the sample size becomes larger,
the power also becomes larger. What’s more, F-test’s power is always
larger than Count Five test.</p>
</div>
<div id="discussion" class="section level2">
<h2>Discussion</h2>
<p><strong>Problem</strong><br />
</p>
<ul>
<li><p>If we obtain the powers for two methods under a particular
simulation setting with 10,000 experiments: say, 0.651 for one method
and 0.676 for another method. Can we say the powers are different at
0.05 level?</p>
<pre><code> - What is the corresponding hypothesis test problem?

 - Which test can we use? Z-test, two-sample t-test, paired-t test or McNemar test? Why?

 - Please provide the least necessary information for hypothesis testing.</code></pre></li>
</ul>
<p><strong>Answer</strong><br />
</p>
<p>Denote the two methods as method1 and method2, and <span class="math inline">\(p_i=P_{H_a}^{(i)}(p-value\leq\alpha),\
i=1,2\)</span>,the hypothesis test problem is <span class="math display">\[H_0:p_1-p_2=0 \leftrightarrow
H_1:p_1-p_2\neq0.\]</span> Z-test and two-sample test require that the
two methods are independent, but the two methods use the same samples in
each experiment so Z-test and two-sample test are not suitable. We can
use paired t-test and McNemar test if we know further information about
each experiment. In particular, if we know that for each experiment, the
two methods will accept or reject null hypothesis, we’re able to have
pairs and can use paired t-test and McNemar test.<br />
</p>
<p>In conclusion, if we only know the power of each method, there’s no
enough evidence to judge whether the powers are different. However, if
we know the details about each experiment, we can use paired t-test and
McNemar test to judge whether the powers are different.</p>
</div>
<div id="hw5" class="section level2">
<h2>HW5</h2>
</div>
<div id="exercise-7.4" class="section level2">
<h2>Exercise 7.4</h2>
<p><strong>Problem</strong><br />
</p>
<p>Refer to the air-conditioning data set aircondit provided in the boot
package. The <span class="math inline">\(12\)</span> observations are
the times in hours between failures of airconditioning equipment: <span class="math display">\[3, 5, 7, 18, 43, 85, 91, 98, 100, 130, 230,
487.\]</span> Assume that the times between failures follow an
exponential model <span class="math inline">\(Exp(λ)\)</span>.Obtain the
MLE of the hazard rate λ and use bootstrap to estimate the bias and
standard error of the estimate.</p>
<p><strong>Answer</strong><br />
</p>
<p>Since <span class="math inline">\(L(\lambda|x_1,\dots,x_n)=\lambda^ne^{-\lambda\sum_{i=1}^n
x_i},\)</span> we have <span class="math display">\[\begin{aligned}
\frac{d}{d\lambda}logL(\lambda|x_1,\dots,x_n)&amp;=\frac{d}{d\lambda}(nlog\lambda-\lambda
\sum_{i=1}^n x_i)\\
&amp;=\frac{n}{\lambda}-\sum_{i=1}^n x_i
\end{aligned}.\]</span> Thus the <span class="math inline">\(MLE\)</span> of <span class="math inline">\(\lambda\)</span> is <span class="math inline">\(\hat\lambda=\frac{n}{\sum_{i=1}^n
x_i}\)</span>.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;aircondit&quot;</span>,<span class="at">package =</span> <span class="st">&quot;boot&quot;</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">12</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>B <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> aircondit<span class="sc">$</span>hours</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">=</span> n<span class="sc">/</span><span class="fu">sum</span>(x)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>lambdastar <span class="ot">=</span> <span class="fu">numeric</span>(B)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  xstar <span class="ot">=</span> <span class="fu">sample</span>(x,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  lambdastar[i] <span class="ot">=</span> n<span class="sc">/</span><span class="fu">sum</span>(xstar)</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">MLE=</span>lambda,<span class="at">bias=</span><span class="fu">mean</span>(lambdastar)<span class="sc">-</span>lambda,<span class="at">se=</span><span class="fu">sd</span>(lambdastar)),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>##    MLE   bias     se 
## 0.0093 0.0011 0.0042</code></pre>
<p>From the results, the obtained MLE of the hazard rate is <span class="math inline">\(\hat\lambda=0.0093\)</span>, the bias is <span class="math inline">\(0.0011\)</span> and the standard error is <span class="math inline">\(0.0042\)</span>.</p>
</div>
<div id="exercise-7.5" class="section level2">
<h2>Exercise 7.5</h2>
<p><strong>Problem</strong><br />
</p>
<p>Refer to Exercise 7.4. Compute <span class="math inline">\(95\%\)</span> bootstrap confidence intervals for
the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard normal, basic,
percentile, and BCa methods. Compare the intervals and explain why they
may differ.</p>
<p><strong>Answer</strong><br />
</p>
<p>Recall the four methods first.<br />
</p>
<ul>
<li>standard normal:<span class="math inline">\((\hat\theta-z_{1-\alpha/2}\hat{se}(\hat\theta),\hat\theta-z_{\alpha/2}\hat{se}(\hat\theta))\)</span></li>
<li>basic:<span class="math inline">\((2\hat\theta-\hat\theta^*_{1-\alpha/2},2\hat\theta-\hat\theta^*_{\alpha/2})\)</span></li>
<li>percentile:<span class="math inline">\((\hat\theta^*_{\alpha/2},\hat\theta^*_{1-\alpha/2})\)</span></li>
<li>BCa:<span class="math inline">\((\hat\theta_{\alpha_1}^*,\hat\theta_{\alpha_2}^*)\)</span>
<span class="math display">\[\alpha_1=\phi(\hat z_0+\frac{\hat
z_0+z_{\alpha/2}}{1-\hat a(\hat z_0+z_{\alpha/2})}),\alpha_2=\phi(\hat
z_0+\frac{\hat z_0+z_{1-\alpha/2}}{1-\hat a(\hat
z_0+z_{1-\alpha/2})})\]</span> <span class="math display">\[\hat
z_0=\phi^{-1}(\frac{1}{B}\sum_{i=1}^n
I(\hat\theta^{(b)}&lt;\hat\theta)),\hat
a=\frac{\sum_{i=1}^n(\bar\theta-\theta_i)^3}{6(\sum_{i=1}^n(\bar\theta-\theta_i)^2)^{3/2}}\]</span>
We can use the <strong>boot</strong> and <strong>boot.ci</strong>
functions to construct confidence intervals.</li>
</ul>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>boot.mean <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i) <span class="fu">mean</span>(x[i])</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> aircondit<span class="sc">$</span>hours</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>meantime <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>x,<span class="at">statistic=</span>boot.mean,<span class="at">R =</span> <span class="fl">1e3</span>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(meantime,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>table1 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Methods=</span><span class="fu">c</span>(<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;normal&quot;</span>,<span class="st">&quot;percentile&quot;</span>,<span class="st">&quot;BCa&quot;</span>),<span class="at">lower=</span><span class="fu">round</span>(<span class="fu">c</span>(ci<span class="sc">$</span>basic[<span class="dv">4</span>],ci<span class="sc">$</span>normal[<span class="dv">2</span>],ci<span class="sc">$</span>percent[<span class="dv">4</span>],ci<span class="sc">$</span>bca[<span class="dv">4</span>]),<span class="dv">2</span>),<span class="at">upper=</span><span class="fu">round</span>(<span class="fu">c</span>(ci<span class="sc">$</span>basic[<span class="dv">5</span>],ci<span class="sc">$</span>normal[<span class="dv">3</span>],ci<span class="sc">$</span>percent[<span class="dv">5</span>],ci<span class="sc">$</span>bca[<span class="dv">5</span>]),<span class="dv">2</span>))</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(table1, <span class="at">format =</span> <span class="st">&quot;html&quot;</span>, <span class="at">align=</span><span class="fu">rep</span>(<span class="st">&#39;c&#39;</span>,<span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
Methods
</th>
<th style="text-align:center;">
lower
</th>
<th style="text-align:center;">
upper
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
basic
</td>
<td style="text-align:center;">
24.37
</td>
<td style="text-align:center;">
168.07
</td>
</tr>
<tr>
<td style="text-align:center;">
normal
</td>
<td style="text-align:center;">
32.59
</td>
<td style="text-align:center;">
181.36
</td>
</tr>
<tr>
<td style="text-align:center;">
percentile
</td>
<td style="text-align:center;">
48.09
</td>
<td style="text-align:center;">
191.79
</td>
</tr>
<tr>
<td style="text-align:center;">
BCa
</td>
<td style="text-align:center;">
57.19
</td>
<td style="text-align:center;">
239.11
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>len_norm <span class="ot">=</span> ci<span class="sc">$</span>normal[<span class="dv">3</span>]<span class="sc">-</span>ci<span class="sc">$</span>normal[<span class="dv">2</span>]</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>len_basic <span class="ot">=</span> ci<span class="sc">$</span>basic[<span class="dv">5</span>]<span class="sc">-</span>ci<span class="sc">$</span>basic[<span class="dv">4</span>]</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>len_perc <span class="ot">=</span> ci<span class="sc">$</span>percent[<span class="dv">5</span>]<span class="sc">-</span>ci<span class="sc">$</span>percent[<span class="dv">4</span>]</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>len_bca <span class="ot">=</span> ci<span class="sc">$</span>bca[<span class="dv">5</span>]<span class="sc">-</span>ci<span class="sc">$</span>bca[<span class="dv">4</span>]</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;norm =&#39;</span>,len_norm,<span class="st">&#39;basic =&#39;</span>,len_basic,<span class="st">&#39;perc =&#39;</span>,len_perc,<span class="st">&#39;BCa =&#39;</span>,len_bca)</span></code></pre></div>
<pre><code>## norm = 148.7732 basic = 143.6992 perc = 143.6992 BCa = 181.9167</code></pre>
<p>It can be seen that basic and percentile methods have the same
interval length, which is very close to normal method. Bca method’s
length is greater than the other three. The confidence interval of basic
method is more close to left, and confidence intervals of norm,
percentile, BCa is getting closer to right, which means the upper and
lower points are all greater than before. We can draw a histogram to
explain this difference.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">=</span> <span class="fu">mean</span>(x)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>thetastar <span class="ot">=</span> meantime<span class="sc">$</span>t</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(thetastar);<span class="fu">abline</span>(<span class="at">v=</span>theta,<span class="at">col=</span><span class="st">&#39;red&#39;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>thetasort <span class="ot">=</span> <span class="fu">sort</span>(thetastar)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>thetasort[<span class="dv">25</span>],<span class="at">col=</span><span class="st">&quot;cyan&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>);<span class="fu">abline</span>(<span class="at">v=</span>thetasort[<span class="dv">975</span>],<span class="at">col=</span><span class="st">&quot;green&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The cyan, red, green line represents <span class="math inline">\(\hat\theta_{\alpha/2}^*,\hat\theta,\hat\theta_{1-\alpha/2}^*\)</span>
respectively. For basic and percentile method, the theoretical length is
<span class="math inline">\(\hat\theta_{1-\alpha/2}^*-\hat\theta_{\alpha/2}^*.\)</span>
Normal method uses the asymptotic distribution of <span class="math inline">\(\hat\theta\)</span> so the length is close to
basic. Bca method has an acceleration adjustment <span class="math inline">\(\hat a\)</span> so the length is greater.<br />
</p>
<p>The center of the interval for basic, normal and percentile methods
are <span class="math display">\[2\hat\theta-\frac{\hat\theta_{\alpha/2}^*+\hat\theta_{1-\alpha/2}^*}{2},\
\hat\theta,\
\frac{\hat\theta_{1-\alpha/2}^*+\hat\theta_{\alpha/2}^*}{2}\]</span>
respectively. It’s shown that <span class="math inline">\(\hat\theta\)</span> is biased and is closer to
left, which means <span class="math display">\[\hat\theta+(\hat\theta-\frac{\hat\theta_{\alpha/2}^*+\hat\theta_{1-\alpha/2}^*}{2})&lt;\hat\theta&lt;\frac{\hat\theta_{\alpha/2}^*+\hat\theta_{1-\alpha/2}^*}{2}.\]</span>
That’s the reason why the intevals are getting closer to right. For BCa
method, it has a bias correction factor <span class="math inline">\(\hat
z_0\)</span> so the center will get closer to right than the other 3
methods.</p>
</div>
<div id="project-7.a" class="section level2">
<h2>Project 7.A</h2>
<p><strong>Problem</strong><br />
</p>
<p>Conduct a Monte Carlo study to estimate the coverage probabilities of
the standard normal bootstrap confidence interval, the basic bootstrap
confidence interval, and the percentile confidence interval. Sample from
a normal population and check the empirical coverage rates for the
sample mean. Find the proportion of times that the confidence intervals
miss on the left, and the proportion of times that the confidence
intervals miss on the right.</p>
<p><strong>Answer</strong><br />
</p>
<p>We use <span class="math inline">\(N(1,1)\)</span> to do the
simulation and generate <span class="math inline">\(n=30\)</span>
samples in each replicate. Repeating the process for <span class="math inline">\(m=1000\)</span> times to calculate the empirical
covering rates, miss on the left and miss on the right.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">30</span> <span class="co"># sample size</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">1000</span> <span class="co"># times to replicate</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>ci.norm <span class="ot">&lt;-</span> ci.basic <span class="ot">&lt;-</span> ci.perc <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  normdata <span class="ot">=</span> <span class="fu">rnorm</span>(n,mu,sigma)</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  de <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>normdata, <span class="at">statistic=</span>boot.mean, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(de,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  ci.norm[i,] <span class="ot">&lt;-</span> ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  ci.basic[i,] <span class="ot">&lt;-</span> ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  ci.perc[i,] <span class="ot">&lt;-</span> ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The results are as below. Here <span class="math inline">\(\mu\)</span> is a fixed value and miss on the left
means the confidence interval is on the left of the true value.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>miss_left <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">mean</span>(ci.norm[,<span class="dv">2</span>]<span class="sc">&lt;=</span>mu),<span class="fu">mean</span>(ci.basic[,<span class="dv">2</span>]<span class="sc">&lt;=</span>mu),<span class="fu">mean</span>(ci.perc[,<span class="dv">2</span>]<span class="sc">&lt;=</span>mu)),<span class="dv">3</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>cover_rate <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mu <span class="sc">&amp;</span> ci.norm[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mu),<span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mu <span class="sc">&amp;</span> ci.basic[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mu),<span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mu <span class="sc">&amp;</span> ci.perc[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mu))</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>miss_right <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="sc">&gt;=</span>mu),<span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="sc">&gt;=</span>mu),<span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="sc">&gt;=</span>mu))</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>table2 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Methods=</span><span class="fu">c</span>(<span class="st">&quot;normal&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;percentile&quot;</span>),miss_left, cover_rate, miss_right)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(table2, <span class="at">format =</span> <span class="st">&quot;html&quot;</span>, <span class="at">align=</span><span class="fu">rep</span>(<span class="st">&#39;c&#39;</span>,<span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>()</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
Methods
</th>
<th style="text-align:center;">
miss_left
</th>
<th style="text-align:center;">
cover_rate
</th>
<th style="text-align:center;">
miss_right
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
normal
</td>
<td style="text-align:center;">
0.019
</td>
<td style="text-align:center;">
0.955
</td>
<td style="text-align:center;">
0.026
</td>
</tr>
<tr>
<td style="text-align:center;">
basic
</td>
<td style="text-align:center;">
0.023
</td>
<td style="text-align:center;">
0.951
</td>
<td style="text-align:center;">
0.026
</td>
</tr>
<tr>
<td style="text-align:center;">
percentile
</td>
<td style="text-align:center;">
0.021
</td>
<td style="text-align:center;">
0.951
</td>
<td style="text-align:center;">
0.028
</td>
</tr>
</tbody>
</table>
</div>
<div id="hw6" class="section level2">
<h2>HW6</h2>
</div>
<div id="exercise-7.8" class="section level2">
<h2>Exercise 7.8</h2>
<div id="problem" class="section level3">
<h3>Problem</h3>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and
standard error of <span class="math inline">\(\hat\theta\)</span>.</p>
</div>
<div id="answer-5" class="section level3">
<h3>Answer</h3>
<p>We use “leave-one-out” to obtain <span class="math inline">\(\hat\Sigma_{(i)}\)</span> and compute <span class="math inline">\(\hat\theta_{(i)}\)</span>. Notice that the MLE of
<span class="math inline">\(\Sigma\)</span> is <span class="math display">\[\hat\Sigma=\frac{1}{n}\sum_{i=1}^n(X_{(i)}-\bar
X)(X_{(i)}-\bar X)^T\]</span>, so we need to slightly modify the
cov(X).</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;scor&quot;</span>,<span class="at">package=</span><span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>data1 <span class="ot">=</span> scor</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">nrow</span>(data1)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>sigma.hat <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">5</span>)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>lambda.hat <span class="ot">=</span> <span class="fu">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>theta.jack <span class="ot">=</span> <span class="fu">numeric</span>(n)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  data_jack <span class="ot">=</span> data1[<span class="sc">-</span>i,]  <span class="co"># leave-one-out</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  sigma.hat <span class="ot">=</span> (n<span class="dv">-2</span>)<span class="sc">*</span><span class="fu">cov</span>(data_jack)<span class="sc">/</span>(n<span class="dv">-1</span>) <span class="co"># MLE of Sigma</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  lambda.hat <span class="ot">=</span> <span class="fu">eigen</span>(sigma.hat)<span class="sc">$</span>values</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  theta.jack[i] <span class="ot">=</span> lambda.hat[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda.hat)</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">=</span> (n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">cov</span>(data1)<span class="sc">/</span>n</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>lambda.hat <span class="ot">=</span> <span class="fu">eigen</span>(sigma)<span class="sc">$</span>values</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">=</span> lambda.hat[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda.hat)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>bias.jack <span class="ot">=</span> (n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta.jack)<span class="sc">-</span>theta.hat)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>se.jack <span class="ot">=</span> <span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((theta.jack<span class="sc">-</span><span class="fu">mean</span>(theta.hat))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">bias.jack=</span>bias.jack,<span class="at">se.jack=</span>se.jack),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## bias.jack   se.jack 
##     0.001     0.050</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co">#clear memory</span></span></code></pre></div>
</div>
</div>
<div id="exercise-7.11" class="section level2">
<h2>Exercise 7.11</h2>
<div id="problem-1" class="section level3">
<h3>Problem</h3>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to
select the best fitting model. Use leave-two-out cross validation to
compare the models.</p>
</div>
<div id="answer-6" class="section level3">
<h3>Answer</h3>
<p>For leave-two-out cross validation, the procedure is as below.<br />
</p>
<ol style="list-style-type: decimal">
<li><p>For <span class="math inline">\(i=1,2,\dots,n;j=1,2,\dots,n;i\neq
j\)</span>, let <span class="math inline">\((x_i,y_i),(x_j,y_j)\)</span>
be the test point and use the remaining observations to fit the model.
Compute the prediction error <span class="math inline">\(e_{ij1}=y_i-\hat y_i,e_{ij2}=y_j-\hat
y_j\)</span>.<br />
</p></li>
<li><p>Estimate the mean of the squared prediction errors <span class="math inline">\(\displaystyle\hat\sigma_{\epsilon}^2=\frac{2}{n(n-1)}\sum_{i=1}^{n-1}\sum_{j=i+1}^ne_{ij}^2\)</span>,
where <span class="math inline">\(e_{ij}^2=\frac{e_{ij1}^2+e_{ij2}^2}{2}\)</span>.</p></li>
</ol>
<p>Notice that there are <span class="math inline">\(n(n+1)/2\)</span>
zeros in the matrix <span class="math inline">\(e_k\)</span>, so we need
to slightly modify the mean when computing.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DAAG); <span class="fu">attach</span>(ironslag)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic) </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,n,n) <span class="co"># store the squared prediction errors</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models on leave-two-out samples</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)){</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n){</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span><span class="fu">c</span>(i,j)]</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span><span class="fu">c</span>(i,j)]</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>    J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>    yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[<span class="fu">c</span>(i,j)]</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>    e1[i,j] <span class="ot">&lt;-</span> <span class="fu">mean</span>((magnetic[<span class="fu">c</span>(i,j)] <span class="sc">-</span> yhat1)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>    J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>    yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J2<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[<span class="fu">c</span>(i,j)]<span class="sc">+</span>J2<span class="sc">$</span>coef[<span class="dv">3</span>]<span class="sc">*</span>chemical[<span class="fu">c</span>(i,j)]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>    e2[i,j] <span class="ot">&lt;-</span> <span class="fu">mean</span>((magnetic[<span class="fu">c</span>(i,j)] <span class="sc">-</span> yhat2)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>    J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>    logyhat3 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[<span class="fu">c</span>(i,j)]</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>    yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>    e3[i,j] <span class="ot">&lt;-</span> <span class="fu">mean</span>((magnetic[<span class="fu">c</span>(i,j)] <span class="sc">-</span> yhat3)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>    J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> <span class="fu">log</span>(x))</span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>    logyhat4 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(chemical[<span class="fu">c</span>(i,j)])</span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>    yhat4 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat4)</span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>    e4[i,j] <span class="ot">&lt;-</span> <span class="fu">mean</span>((magnetic[<span class="fu">c</span>(i,j)] <span class="sc">-</span> yhat4)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span>n<span class="sc">/</span>(n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">c</span>(<span class="fu">mean</span>(e1), <span class="fu">mean</span>(e2), <span class="fu">mean</span>(e3), <span class="fu">mean</span>(e4))</span></code></pre></div>
<pre><code>## [1] 19.57227 17.87018 18.45491 20.46718</code></pre>
<p>According to the prediction error criterion, Model 2, the quadratic
model, would be the best fit for the data. This result is the same as
leave-one-out method.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>
</div>
<div id="exercise-8.2" class="section level2">
<h2>Exercise 8.2</h2>
<div id="problem-2" class="section level3">
<h3>Problem</h3>
<p>Implement the bivariate Spearman rank correlation test for
independence as a permutation test. The Spearman rank correlation test
statistic can be obtained from function <strong>cor</strong> with
<strong>method = “spearman”</strong>. Compare the achieved significance
level of the permutation test with the <span class="math inline">\(p\)</span>-value reported by
<strong>cor.test</strong> on the same samples.</p>
</div>
<div id="answer-7" class="section level3">
<h3>Answer</h3>
<p>We use a multivariate normal distribution to do the simulation.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;MASS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:DAAG&#39;:
## 
##     hills</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     select</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">20</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>Sigma <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">mvrnorm</span>(n, mu, Sigma)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> X[,<span class="dv">1</span>]; y <span class="ot">=</span> X[,<span class="dv">2</span>] <span class="co"># two samples</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>R <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R)</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>r0 <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, y, <span class="at">method=</span><span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R){</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>  x_per <span class="ot">&lt;-</span> <span class="fu">sample</span>(x, <span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>  reps[i] <span class="ot">=</span> <span class="fu">cor</span>(x_per, y, <span class="at">method=</span><span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">mean</span>(<span class="fu">abs</span>(reps)<span class="sc">&gt;=</span><span class="fu">abs</span>(r0)) <span class="co"># empirical p-value</span></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(p,<span class="fu">cor.test</span>(x,y,<span class="at">method=</span><span class="st">&quot;spearman&quot;</span>)<span class="sc">$</span>p.value),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.0300 0.0303</code></pre>
<p>The achieved significance level of the permutation test is close to
the <span class="math inline">\(p\)</span>-value reported by
<strong>cor.test</strong>.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>
</div>
<div id="hw7" class="section level2">
<h2>HW7</h2>
</div>
<div id="exercise-9.4" class="section level2">
<h2>Exercise 9.4</h2>
<p><strong>Problem</strong></p>
<p>Implement a random walk Metropolis sampler for generating the
standard Laplace distribution (see Exercise 3.2). For the increment,
simulate from a normal distribution. Compare the chains generated when
different variances are used for the proposal distribution. Also,
compute the acceptance rates of each chain.</p>
<p><strong>Answer</strong></p>
<p>The density function of Laplace distribution is <span class="math inline">\(f(x)=\frac{1}{2}e^{-|x|}\)</span>, so <span class="math inline">\(r(x_t,y)=\frac{f(Y)}{f(X_t)}=e^{|y|-|x|}\)</span>.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(x))<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>invF <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x)))</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>rw.Laplace <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, x0, N){</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">numeric</span>(N)</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">=</span> x0</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">=</span> <span class="fu">runif</span>(N)</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> (<span class="fu">f</span>(y)<span class="sc">/</span><span class="fu">f</span>(x[i<span class="dv">-1</span>])))</span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>    x[i] <span class="ot">=</span> y <span class="cf">else</span> {</span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>    x[i] <span class="ot">=</span> x[i<span class="dv">-1</span>]</span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">=</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x, <span class="at">k=</span>k))</span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a><span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a><span class="co"># for chain in i-th row of X</span></span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a>  psi <span class="ot">=</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">=</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">=</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a>  psi.means <span class="ot">=</span> <span class="fu">rowMeans</span>(psi) <span class="co">#row means</span></span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">=</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means) <span class="co">#between variance est.</span></span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true" tabindex="-1"></a>  psi.w <span class="ot">=</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></span>
<span id="cb67-33"><a href="#cb67-33" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">=</span> <span class="fu">mean</span>(psi.w) <span class="co">#within est.</span></span>
<span id="cb67-34"><a href="#cb67-34" aria-hidden="true" tabindex="-1"></a>  v.hat <span class="ot">=</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n) <span class="co">#upper variance est.</span></span>
<span id="cb67-35"><a href="#cb67-35" aria-hidden="true" tabindex="-1"></a>  r.hat <span class="ot">=</span> v.hat <span class="sc">/</span> W <span class="co">#G-R statistic</span></span>
<span id="cb67-36"><a href="#cb67-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb67-37"><a href="#cb67-37" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">12000</span> <span class="co">#length of chains</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>k <span class="ot">=</span> <span class="dv">4</span> <span class="co">#number of chains to generate</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">10</span>) <span class="co">#different initial values</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">2</span>, <span class="dv">5</span>) <span class="co">#different variance</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> X2 <span class="ot">&lt;-</span> X3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,k,n)</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>rej <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>refline <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fu">invF</span>(<span class="fl">0.975</span>), <span class="fu">invF</span>(<span class="fl">0.975</span>))</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>  rw1 <span class="ot">=</span> <span class="fu">rw.Laplace</span>(sigma[<span class="dv">1</span>], x0[i], n)</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>  rw2 <span class="ot">=</span> <span class="fu">rw.Laplace</span>(sigma[<span class="dv">2</span>], x0[i], n)</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>  rw3 <span class="ot">=</span> <span class="fu">rw.Laplace</span>(sigma[<span class="dv">3</span>], x0[i], n)</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>  X1[i,]<span class="ot">=</span>rw1<span class="sc">$</span>x;X2[i,]<span class="ot">=</span>rw2<span class="sc">$</span>x;X3[i,]<span class="ot">=</span>rw3<span class="sc">$</span>x</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>  rej[,i] <span class="ot">=</span> <span class="fu">c</span>(rw1<span class="sc">$</span>k,rw2<span class="sc">$</span>k,rw3<span class="sc">$</span>k)</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a><span class="co"># compute diagnostic statistics</span></span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>psi1 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X1, <span class="dv">1</span>, cumsum))</span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>psi2 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X2, <span class="dv">1</span>, cumsum))</span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>psi3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X3, <span class="dv">1</span>, cumsum))</span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a>  psi1[i,] <span class="ot">=</span> psi1[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi1))</span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a>  psi2[i,] <span class="ot">=</span> psi2[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi2))</span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a>  psi3[i,] <span class="ot">=</span> psi3[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi3))</span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="fu">Gelman.Rubin</span>(psi1),<span class="fu">Gelman.Rubin</span>(psi2),<span class="fu">Gelman.Rubin</span>(psi3)))</span></code></pre></div>
<pre><code>## [1] 1.153902 1.096606 1.069531</code></pre>
<p>We choose the first chain of each variance and plot the generated
samples. Also, we plot the <span class="math inline">\(\hat R\)</span>
over time 1001 to 12000 to monitor convergence.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow=c(2,2))</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X1[<span class="dv">1</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">2000</span>], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="fu">bquote</span>(sigma<span class="sc">==</span><span class="fl">0.5</span>), <span class="at">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="at">ylim=</span><span class="fu">range</span>(X1[<span class="dv">1</span>,]))</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span>refline)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X2[<span class="dv">1</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">2000</span>], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="fu">bquote</span>(sigma<span class="sc">==</span><span class="dv">2</span>), <span class="at">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="at">ylim=</span><span class="fu">range</span>(X2[<span class="dv">1</span>,]))</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span>refline)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X3[<span class="dv">1</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">2000</span>], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="fu">bquote</span>(sigma<span class="sc">==</span><span class="dv">5</span>), <span class="at">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="at">ylim=</span><span class="fu">range</span>(X3[<span class="dv">1</span>,]))</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span>refline)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>rhat1 <span class="ot">&lt;-</span> rhat2 <span class="ot">&lt;-</span> rhat3 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n){</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  rhat1[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi1[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  rhat2[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi2[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  rhat3[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi3[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow=c(2,2))</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat1[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat2[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat3[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">apply</span>(rej, <span class="dv">1</span>, mean)<span class="sc">/</span>n</span></code></pre></div>
<pre><code>## [1] 0.8297292 0.5280208 0.2873750</code></pre>
<p>From the results, the value of <span class="math inline">\(\hat
R\)</span> is below 1.2 within approximately 9000, 3000, 1500 iterations
for <span class="math inline">\(\sigma=0.5,2,5\)</span>, respectively,
which implies that the chain has converged to the target distribution.
It’s evident that as the variance become larger, the chain will converge
faster but the acceptance rate will become smaller.</p>
</div>
<div id="exercise-9.7" class="section level2">
<h2>Exercise 9.7</h2>
<p><strong>Problem</strong></p>
<p>Implement a Gibbs sampler to generate a bivariate normal chain <span class="math inline">\((X_t, Y_t)\)</span> with zero means, unit standard
deviations, and correlation 0.9. Plot the generated sample after
discarding a suitable burn-in sample. Fit a simple linear regression
model <span class="math inline">\(Y = \beta_0 + \beta_1X\)</span> to the
sample and check the residuals of the model for normality and constant
variance.</p>
<p><strong>Answer</strong></p>
<p>First we define a function to use Gibbs sampler to generate a
bivariate normal chain <span class="math inline">\((X_t,Y_t)\)</span>.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>Gibbs.binorm <span class="ot">&lt;-</span> <span class="cf">function</span>(N,<span class="at">mu1=</span><span class="dv">0</span>,<span class="at">mu2=</span><span class="dv">0</span>,<span class="at">sigma1=</span><span class="dv">1</span>,<span class="at">sigma2=</span><span class="dv">1</span>,<span class="at">rho=</span><span class="fl">0.9</span>,<span class="at">x0=</span><span class="fu">c</span>(mu1,mu2)){</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  s1 <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma1</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  s2 <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma2</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>,] <span class="ot">=</span> x0</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>    y1 <span class="ot">=</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>    m1 <span class="ot">=</span> mu1 <span class="sc">+</span> rho <span class="sc">*</span> (y1 <span class="sc">-</span> mu2) <span class="sc">*</span> sigma1<span class="sc">/</span>sigma2</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>    X[i, <span class="dv">1</span>] <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m1, s1)</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">=</span> X[i, <span class="dv">1</span>]</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>    m2 <span class="ot">=</span> mu2 <span class="sc">+</span> rho <span class="sc">*</span> (x1 <span class="sc">-</span> mu1) <span class="sc">*</span> sigma2<span class="sc">/</span>sigma1</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>    X[i, <span class="dv">2</span>] <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m2, s2)</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(X)</span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>To monitor the convergence of the chain, we set the scalar summary
statistic <span class="math inline">\(\psi_{ij}\)</span> as the mean of
the <span class="math inline">\(i^{th}\)</span> chain up to time <span class="math inline">\(j\)</span> and do the process separately for <span class="math inline">\(X_t\)</span> and <span class="math inline">\(Y_t\)</span>.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">=</span> <span class="dv">4</span> <span class="co">#number of chains to generate</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">10000</span> <span class="co">#length of chain</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span><span class="sc">*</span>k)</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>Xt <span class="ot">&lt;-</span> Yt <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,k,N)</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="dv">1</span>),<span class="dv">2</span>),<span class="dv">4</span>) <span class="co">#initial values</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>psix <span class="ot">=</span> psiy <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,k,N)</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>  X[,(<span class="dv">2</span><span class="sc">*</span>i<span class="dv">-1</span>)<span class="sc">:</span>(<span class="dv">2</span><span class="sc">*</span>i)] <span class="ot">=</span> <span class="fu">Gibbs.binorm</span>(N,<span class="at">x0=</span>x0[i,])</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>  Xt[i,] <span class="ot">=</span> <span class="fu">t</span>(X[,<span class="dv">2</span><span class="sc">*</span>i<span class="dv">-1</span>])</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>  Yt[i,] <span class="ot">=</span> <span class="fu">t</span>(X[,<span class="dv">2</span><span class="sc">*</span>i])</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>psix <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">apply</span>(Xt, <span class="dv">1</span>, cumsum))</span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>psiy <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">apply</span>(Yt, <span class="dv">1</span>, cumsum))</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>  psix[i,] <span class="ot">=</span> psix[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psix))</span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>  psiy[i,] <span class="ot">=</span> psiy[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psiy))</span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="fu">Gelman.Rubin</span>(psix),<span class="fu">Gelman.Rubin</span>(psiy)))</span></code></pre></div>
<pre><code>## [1] 1.003882 1.017699</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>rhatx <span class="ot">=</span> rhaty <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>,N)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N){</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  rhatx[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psix[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  rhaty[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psiy[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow=c(1,2))</span></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhatx[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="fu">bquote</span>(X[t]), <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhaty[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="fu">bquote</span>(Y[t]), <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The figures of <span class="math inline">\(\hat R\)</span> shows that
the chain converges approximately within 2000 iterations. Next, we use
the first generated chain to show the samples and other chains’ figure
is similar to it. The generated samples are shown as below. The scatter
plot seems like an ellipse which conforms to a bivariate normal
distribution.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> X[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">cex=</span>.<span class="dv">5</span>, <span class="at">xlab=</span><span class="fu">bquote</span>(X[t]),</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="at">ylab=</span><span class="fu">bquote</span>(Y[t]), <span class="at">ylim=</span><span class="fu">range</span>(x[,<span class="dv">2</span>]))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAV1BMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6OpA6kNtmAABmAGZmOpBmkJBmtv+QOgCQ2/+2ZgC2///bkDrb2//b/7bb/9vb////tmb/25D//7b//9v///+DuazUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIRElEQVR4nO2d7WLjJhBF6SZpG3db13F31x96/+esZQmELOELwyBh+54f2d0UofHpAAIRYhpyF7N2ALVDQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAOoLM47GsoFLVlYOCQvS5Q0EBTB8jBQWgIMSLN7FhdPLHqZkx60UFGReB8WIxM3FREAXN33/cxGyHwyZ2vfek1zGhTuklBc00KtNamWlzTVlBB2N++1evOi1GgvrJVvuHGbJpXDq62gR2xnwe//zVnDb/aFSny1VG/4ezYvrvLtPEdm+/mt01e/aXv2VXp4frjK9ihpZlZS3USV/z5vh7K+jw7WscYOoqgire/KHLIRdIH9Rigj4vX8//NbVlkMsa41KmzyX7jblLouuOZ2/zplOVW50eg5zhX41TZOxw74kq1Envu+HrYAJ99IqddCej8fod41u65tj4QSC6XuUwF8aN5zcrqrfN7FUFuTH9pv8Zi1qsiS1dXcQNh95nZmV+cHc7kr2MIKel8b7OpNHthPVFBAWSZizGPgTIAn1oQYEeZ9rEpgsezypo9EFB/rhphpm5+EkF2WWM+aF9VtKgZTSff1ZBfY/SuGfk4ODV5854ZH8VQebuuD4SNL5aEOhDCXIrPs4TbGD2OnGgOp9oElIZjH0gjsJ9ODPzMZ8zg/wJOm5e871zaqCPIWi8/hWbQRU1sVLVDbV2Fcersa0sO9CHEZTQ+QyiFAKtXdDwRiLVzv1QnkWQbVwRDz2emAhDzyUo3s3oT5VAKxcU9cAcMKUTaOWCRH66dxpKgdYtSJI8ZjSFzw60ZkFG1r50A61YkKz3iYygiKDTZghj/G5eVB1C8uwTPVsuk0HnbchLanwxFMyfYk3svH3XrG7mejujkHbQuHtODDTxE4Xfyouqm7ncSPue3k9kDA/aSecKml/7yQq0KkF9G5Gljlsy0g20JkFGPLR32VMk0NoE2XQQ5o9+oH7B019f/Rcx+U1Mkjt46iUPdCh43na3C+w+VL5v6GqxoVKBmub03RrJS560+85fLU2hgoGadgIBnv5K3Hf2YqkewV2TmtjegMe/AvcdXyV+cE54NBQG2hXchSafxe7bF7cdrFyPpANKCbQvePy43i9bU1qsdsVZLkiWPimBXgteBrBVMshkPTzbrQxlA20L7rL7IP//aNp10lX5ftYva1/N44xi8mWNpQL1n4MUSH9gEyJOndRAV52Libvn+GWN7EDXFGTkaz8vIUimxhl6/iaWo2e5QNcTlGHnFQSJ7egkUPWCxOmjkz+FBCm9Wc14fO5yqK8kizIZFHyzmlKdaXL82D15CouXygWvaLxZzXixY1wLq1VQ/pvVrOmpGZpWnU0sXIv3KdDtZPnT5ZBKsDYQ5YI61WV1PpqxlhR03gaOXcDVybNHV0+tgmqxAwOVFBwQC5L0zvZCbeoTZGQ7ektRiyD/J5KcofifiCtHJaOYe55Lzx3VQR0GqlBQVF2OoKJ+ahEk+1HB8nrqEWS/nWqHglZOoMcWVD5/ahOU+vOCZQewO4HmFBRVZyRj2BIJVMlyh1vCqcqNDU25oKQ6kzbD0HpjkR6oRkFRdW4ZMMpPkVlpXKAKBROq8z5mwgqibiBRgaoWjK/Om190y4CwmamHEReobsH46vw3D/YAzPt+lk6fpo4mZreghnOof5PjtcjX6IPcPyYHIt1autlmuGBbq0KQN5kPLZU14WPYylJSUOKh/3afXXPrZWa9+eGbmODQ/3DyNEsKmYalXbBFcOh/qHu2pdcyVERQ+ND/YHXeVMzPJO+/Jtxfk0KCYg/971ct/NmYG8xGxZ+sicUe+m/cLGw0Rins3lWjUCcdOvT/pnPxBI3u9PyCYquzTczfzeMWh6qgpKD4N6v+rKxR3r+SSZWCamleLXUIGm+YoyBUHZtYTSkCqGQ2Xy8UBFhN0MOwkqDI+mv4biQUBKAgAAUBKAhAQQAKAlAQgIIADzM3WAsKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEKC1of2dL7JTjH5Fn7kYXTAxgSmFB7Z60Q3SAp03kocTRBRMDmKGsoOtWPXhsleUQe6B1dMHEAOZYoA+Kje9gPkObZ4UFEwOYZQFB+/gMj/7cSYISAphSXNClOYR3y0wKFxCUFMCURZpY9O8yKZNBCQFMWeI5KH4UKSMoaxgrJujy/GFT+/gBjsx3ZQsJggHcoWwGdZHFfxp1QakBTCncxNqfD7q3p/EG/QxKDGBK6T5oZ1J+J0WBJpYWwBROVgEUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCVC3o+NHtOtjn/rr3DKoW1G6ValpPOftXMqlbULP79pW3QSybygWdNu/D4YSrULmgS/P6O2PvigK1C7p00Ct2QE39gs7b2B2/hahd0O7tx2bNPrp2Qe2hqNex/vRdvg8zi7oFHT/a7GmPsG6P+V6FqgX1v538tHn7uTUZW3lzqFnQpYPuRviDeWcGASgIQEEACgJcOmp20lVCQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUB/geXMB8CyLJuAwAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">lm</span>(x[,<span class="dv">2</span>] <span class="sc">~</span> x[,<span class="dv">1</span>]) <span class="co">#linear model Y=a+bX</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = x[, 2] ~ x[, 1])
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.79665 -0.29891  0.00383  0.29448  1.58147 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -0.003998   0.004600  -0.869    0.385    
## x[, 1]       0.897740   0.004656 192.795   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4364 on 8998 degrees of freedom
## Multiple R-squared:  0.8051, Adjusted R-squared:  0.8051 
## F-statistic: 3.717e+04 on 1 and 8998 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the QQ plot we can see that the residuals of the model
approximately follow a normal distribution. Besides, from the
Scale-Location plot we can see that the trend line is nearly horizontal
so the residuals have constant variance.</p>
</div>
<div id="hw8" class="section level2">
<h2>HW8</h2>
</div>
<div id="question-1-2" class="section level2">
<h2>Question 1</h2>
<p>Let <span class="math inline">\(X\sim Exp(2)\)</span>,<span class="math inline">\(a_M=a_Y=1\)</span>. We can write a function to
compute the statistic <span class="math display">\[T=\frac{\hat\alpha\hat\beta}{\hat{se}(\hat\alpha\hat\beta)},\]</span>
where <span class="math inline">\(\hat{se}(\hat\alpha\hat\beta)=\sqrt{\hat\alpha^2\hat{se}(\hat\beta)^2+\hat\beta^2\hat{se}(\hat\alpha)^2}\)</span>.
In the permutation test, when <span class="math inline">\(\alpha=\beta=0\)</span>, we can simply permute
<span class="math inline">\(M\)</span>. When <span class="math inline">\(\alpha=0,\beta=1\)</span>, we can permute <span class="math inline">\(X\)</span> to test <span class="math inline">\(X\)</span> and <span class="math inline">\(M\)</span> are irrelevant or not. When <span class="math inline">\(\alpha=1,\beta=0\)</span>, we can permute <span class="math inline">\(Y\)</span> and <span class="math inline">\(\hat\alpha\)</span> will remain so we can test
whether <span class="math inline">\(Y\)</span> is irrelevant to <span class="math inline">\(M\)</span>.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>T <span class="ot">&lt;-</span> <span class="cf">function</span>(x,m,y){</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  fit1 <span class="ot">=</span> <span class="fu">lm</span>(m <span class="sc">~</span> x)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> m<span class="sc">+</span>x)</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  alpha.hat <span class="ot">=</span> fit1<span class="sc">$</span>coef[[<span class="dv">2</span>]]</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>  beta.hat <span class="ot">=</span> fit2<span class="sc">$</span>coef[[<span class="dv">2</span>]]</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>  se1 <span class="ot">=</span> <span class="fu">summary</span>(fit1)<span class="sc">$</span>coef[<span class="dv">2</span>,<span class="dv">2</span>]</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>  se2 <span class="ot">=</span> <span class="fu">summary</span>(fit2)<span class="sc">$</span>coef[<span class="dv">2</span>,<span class="dv">2</span>]</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>  seab <span class="ot">=</span> <span class="fu">sqrt</span>(alpha.hat<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>se2<span class="sc">+</span>beta.hat<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>se1)</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(alpha.hat<span class="sc">*</span>beta.hat<span class="sc">/</span>seab)</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We use permutation to obtain a empirical p-value each time and repeat
the process for <span class="math inline">\(N=100\)</span> times to
calculate the rate of type1 error.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>R <span class="ot">=</span> <span class="dv">100</span> <span class="co">#times to repeat in permutation</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">20</span> <span class="co">#sample size</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">100</span> </span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>); beta <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>); gamma<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>t1err <span class="ot">=</span> <span class="fu">numeric</span>(<span class="dv">3</span>)</span></code></pre></div>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>Ts <span class="ot">=</span> <span class="fu">numeric</span>(R)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">numeric</span>(N)</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">=</span> <span class="fu">rexp</span>(n,<span class="dv">2</span>)</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  m1 <span class="ot">=</span> <span class="dv">1</span><span class="sc">+</span>alpha[<span class="dv">1</span>]<span class="sc">*</span>x1<span class="sc">+</span><span class="fu">rnorm</span>(n)</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>  y1 <span class="ot">=</span> <span class="dv">1</span><span class="sc">+</span>gamma<span class="sc">*</span>x1<span class="sc">+</span>beta[<span class="dv">1</span>]<span class="sc">*</span>m1<span class="sc">+</span><span class="fu">rnorm</span>(n)</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>  T0 <span class="ot">=</span> <span class="fu">T</span>(x1,m1,y1)</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R){</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>    m_per <span class="ot">=</span> <span class="fu">sample</span>(m1, <span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>    Ts[j] <span class="ot">=</span> <span class="fu">T</span>(x1,m_per,y1)</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>  p[i] <span class="ot">=</span> <span class="fu">mean</span>(<span class="fu">abs</span>(Ts)<span class="sc">&gt;=</span><span class="fu">abs</span>(T0))</span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>t1err[<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">mean</span>(p<span class="sc">&lt;</span><span class="fl">0.05</span>)</span></code></pre></div>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>Ts <span class="ot">=</span> <span class="fu">numeric</span>(R)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">numeric</span>(N)</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">=</span> <span class="fu">rexp</span>(n,<span class="dv">2</span>)</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>  m2 <span class="ot">=</span> <span class="dv">1</span><span class="sc">+</span>alpha[<span class="dv">2</span>]<span class="sc">*</span>x2<span class="sc">+</span><span class="fu">rnorm</span>(n)</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>  y2 <span class="ot">=</span> <span class="dv">1</span><span class="sc">+</span>gamma<span class="sc">*</span>x2<span class="sc">+</span>beta[<span class="dv">2</span>]<span class="sc">*</span>m2<span class="sc">+</span><span class="fu">rnorm</span>(n)</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>  T0 <span class="ot">=</span> <span class="fu">T</span>(x2,m2,y2)</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R){</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>    x_per <span class="ot">=</span> <span class="fu">sample</span>(x2, <span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>    Ts[j] <span class="ot">=</span> <span class="fu">T</span>(x_per,m2,y2)</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>  p[i] <span class="ot">=</span> <span class="fu">mean</span>(<span class="fu">abs</span>(Ts)<span class="sc">&gt;=</span><span class="fu">abs</span>(T0))</span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>t1err[<span class="dv">2</span>] <span class="ot">=</span> <span class="fu">mean</span>(p<span class="sc">&lt;</span><span class="fl">0.05</span>)</span></code></pre></div>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>Ts <span class="ot">=</span> <span class="fu">numeric</span>(R)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">numeric</span>(N)</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>  x3 <span class="ot">=</span> <span class="fu">rexp</span>(n,<span class="dv">2</span>)</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>  m3 <span class="ot">=</span> <span class="dv">1</span><span class="sc">+</span>alpha[<span class="dv">3</span>]<span class="sc">*</span>x3<span class="sc">+</span><span class="fu">rnorm</span>(n)</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>  y3 <span class="ot">=</span> <span class="dv">1</span><span class="sc">+</span>gamma<span class="sc">*</span>x3<span class="sc">+</span>beta[<span class="dv">3</span>]<span class="sc">*</span>m3<span class="sc">+</span><span class="fu">rnorm</span>(n)</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>  T0 <span class="ot">=</span> <span class="fu">T</span>(x3,m3,y3)</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R){</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>    y_per <span class="ot">=</span> <span class="fu">sample</span>(y3, <span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>    Ts[j] <span class="ot">=</span> <span class="fu">T</span>(x3,m3,y_per)</span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>  p[i] <span class="ot">=</span> <span class="fu">mean</span>(<span class="fu">abs</span>(Ts)<span class="sc">&gt;=</span><span class="fu">abs</span>(T0))</span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>t1err[<span class="dv">3</span>] <span class="ot">=</span> <span class="fu">mean</span>(p<span class="sc">&lt;</span><span class="fl">0.05</span>)</span></code></pre></div>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>table <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">parameters=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="at">typeI.error=</span>t1err)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(table, <span class="at">align=</span><span class="fu">rep</span>(<span class="st">&#39;c&#39;</span>,<span class="dv">2</span>))</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:center;">
parameters
</th>
<th style="text-align:center;">
typeI.error
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0.05
</td>
</tr>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
0.04
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
0.03
</td>
</tr>
</tbody>
</table>
<p>From the results, we can find that through permutation test, the rate
of type1 error can be controlled in a small range.</p>
</div>
<div id="question-2-1" class="section level2">
<h2>Question 2</h2>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>solve.alpha <span class="ot">&lt;-</span> <span class="cf">function</span>(N, b1, b2, b3, f0){</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">=</span> <span class="fu">rpois</span>(N,<span class="dv">1</span>)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">=</span> <span class="fu">rexp</span>(N)</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  x3 <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,N,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha){</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>    tmp <span class="ot">=</span> <span class="fu">exp</span>(<span class="sc">-</span>alpha<span class="sc">-</span>b1<span class="sc">*</span>x1<span class="sc">-</span>b2<span class="sc">*</span>x2<span class="sc">-</span>b3<span class="sc">*</span>x3)</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>tmp)</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(p) <span class="sc">-</span> f0</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>  solution <span class="ot">=</span> <span class="fu">uniroot</span>(g,<span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">0</span>))</span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(solution<span class="sc">$</span>root)</span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="fl">1e6</span>; b1<span class="ot">=</span><span class="dv">0</span>; b2<span class="ot">=</span><span class="dv">1</span>; b3<span class="ot">=</span><span class="sc">-</span><span class="dv">1</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>f0 <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">1e-1</span>,<span class="fl">1e-2</span>,<span class="fl">1e-3</span>,<span class="fl">1e-4</span>)</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fu">numeric</span>(<span class="dv">4</span>)</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>  alpha[i] <span class="ot">=</span> <span class="fu">solve.alpha</span>(N, b1, b2, b3, f0[i])</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>alpha</span></code></pre></div>
<pre><code>## [1]  -3.170740  -6.068241  -8.710694 -11.282443</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(alpha, f0, <span class="at">pch=</span><span class="dv">16</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Note that the scatter plot of <span class="math inline">\(f_0\)</span> and <span class="math inline">\(\alpha\)</span> is close to the expit curve.</p>
</div>
<div id="hw9" class="section level2">
<h2>HW9</h2>
</div>
<div id="class-work" class="section level2">
<h2>Class work</h2>
<p><strong>Directly Optimize</strong></p>
<p>The likelihood function for the observed data is <span class="math display">\[L(\lambda)=\prod_{i=1}^nP(u_i\leq X_i\leq
v_i)=\prod_{i=1}^n(e^{-\lambda u_i}-e^{-\lambda v_i}),\]</span> then we
have <span class="math display">\[logL=\sum_{i=1}^nlog(e^{-\lambda
u_i}-e^{-\lambda v_i}),\]</span> <span class="math display">\[\frac{\partial
logL}{\partial\lambda}=-\lambda\sum_{i=1}^n \frac{u_ie^{-\lambda
u_i}-v_ie^{-\lambda v_i}}{e^{-\lambda u_i}-e^{-\lambda v_i}}.\]</span>
We can obtain the MLE <span class="math inline">\(\hat\lambda\)</span>
by solving the equation <span class="math inline">\(\frac{\partial
logL}{\partial\lambda}=0\)</span>. Codes for achieving the process are
as below(here we can use optimize() to maximize <span class="math inline">\(logL\)</span> directly).</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">27</span>,<span class="dv">28</span>,<span class="dv">13</span>,<span class="dv">14</span>,<span class="dv">16</span>,<span class="dv">17</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">23</span>,<span class="dv">24</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">24</span>,<span class="dv">25</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">matrix</span>(data, <span class="at">nrow=</span><span class="dv">10</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>u <span class="ot">=</span> X[,<span class="dv">1</span>]; v <span class="ot">=</span> X[,<span class="dv">2</span>]</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>logL <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda){</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">log</span>(<span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v)))</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(s)</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">optimize</span>(logL, <span class="at">lower=</span><span class="dv">0</span>, <span class="at">upper=</span><span class="dv">5</span>, <span class="at">maximum=</span><span class="cn">TRUE</span>)</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>lambdahat <span class="ot">=</span> res[[<span class="dv">1</span>]]</span></code></pre></div>
<p><strong>EM algorithm</strong></p>
<p>1.Initiate <span class="math inline">\(\lambda\)</span> as <span class="math inline">\(\lambda_0\)</span><br />
2.E-step: When the interval is given, the conditional expectation is:
<span class="math display">\[E(X|u&lt;X\leq v)=\int_u^v\frac{\lambda_0
xe^{-\lambda_0 x}}{e^{-\lambda_0 u}-e^{-\lambda_0 v}}dx
=\frac{ue^{-\lambda_0 u}-ve^{-\lambda_0 v}}{e^{-\lambda_0
u}-e^{-\lambda_0 v}}+\frac{1}{\lambda_0}.\]</span> 3.M-step: the
log-likelihood is <span class="math display">\[logL=\frac{n}{\lambda}-\lambda\sum_{i=1}^n(\frac{u_ie^{-\lambda_0
u_i}-v_ie^{-\lambda_0 v_i}}{e^{-\lambda_0 u_i}-e^{-\lambda_0
v_i}}+\frac{1}{\lambda_0}),\]</span> so by maximizing <span class="math inline">\(logL\)</span>, we can obtain <span class="math display">\[\lambda_1=\frac{n}{\sum_{i=1}^n\frac{u_ie^{-\lambda_0
u_i}-v_ie^{-\lambda_0 v_i}}{e^{-\lambda_0 u_i}-e^{-\lambda_0
v_i}}+\frac{n}{\lambda_0}}.\]</span> 4.In steps 2 and 3, replace <span class="math inline">\(\lambda_0\)</span> with <span class="math inline">\(\lambda_1\)</span>, and repeat this process until
convergence (iteration).</p>
<p>Denote <span class="math inline">\(f(\lambda)=\frac{n}{\sum_{i=1}^n\frac{u_ie^{-\lambda
u_i}-v_ie^{-\lambda v_i}}{e^{-\lambda u_i}-e^{-\lambda
v_i}}+\frac{n}{\lambda}}\)</span>. We can compute <span class="math inline">\(|f&#39;(\lambda)|&lt;1\)</span> and by the
contraction mapping theorem, the EM process converges to a fixed point
<span class="math inline">\(\tilde\lambda\)</span> which satisfies <span class="math inline">\(\tilde\lambda=f(\tilde\lambda)\)</span>.
Specificly, <span class="math inline">\(\tilde\lambda\)</span> satisfies
<span class="math display">\[\tilde\lambda\sum_{i=1}^n\frac{u_ie^{-\tilde\lambda
u_i}-v_ie^{-\tilde\lambda v_i}}{e^{-\tilde\lambda u_i}-e^{-\tilde\lambda
v_i}}+n=n.\]</span> This is the same equation as <span class="math inline">\(\frac{\partial logL}{\partial\lambda}=0\)</span>
so we claim that <span class="math inline">\(\hat\lambda=\tilde\lambda\)</span>, which means EM
algorithm has the same value as optimizing directly.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>delta <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">=</span> <span class="fu">numeric</span>(<span class="dv">100</span>) </span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>lambda[<span class="dv">1</span>] <span class="ot">=</span> <span class="dv">1</span> <span class="co">#initialize </span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>i <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a><span class="co"># E-step</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>Econd <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda,u,v){ </span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>  (u<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u)<span class="sc">-</span>v<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v))<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v))<span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>lambda</span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span>(delta <span class="sc">&gt;</span> <span class="fl">1e-5</span>){</span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>  lambda[i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">=</span>  n<span class="sc">/</span><span class="fu">sum</span>(<span class="fu">Econd</span>(lambda[i],u,v)) <span class="co"># M-step</span></span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>  delta <span class="ot">=</span> <span class="fu">abs</span>(lambda[i<span class="sc">+</span><span class="dv">1</span>]<span class="sc">-</span>lambda[i])</span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">=</span> i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a>lambdahat.EM <span class="ot">=</span> lambda[i]</span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(lambdahat,lambdahat.EM),<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 0.07197 0.07197</code></pre>
<p>By using numerical methods we can also find the two values are
same.</p>
</div>
<div id="section" class="section level2">
<h2>2.1.3</h2>
<p><strong>Q4:</strong>Why do you need to use unlist() to convert a list
to an atomic vector? Why doesn’t as.vector() work?</p>
<p><strong>A:</strong>Note that list is also a vector but it is not a
atomic vector. Therefore, as.vector() doesn’t work for list. We use
unlist() to get rid of the nested structure.</p>
<p><strong>Q5:</strong>Why is 1 == “1” true? Why is -1 &lt; FALSE true?
Why is “one” &lt; 2 false?</p>
<p><strong>A:</strong>When using operator functions, the arguments will
be coerced to a common type. The hierarchy for coercion is: logical &lt;
integer &lt; numeric &lt; character. In the examples, 1 will be coerced
to “1”, FALSE is represented as 0 and 2 turns into “2”. Numbers precede
letters in lexicographic order so “2” &gt; “one”.</p>
</div>
<div id="section-1" class="section level2">
<h2>2.3.1</h2>
<p><strong>Q1:</strong>What does dim() return when applied to a
vector?</p>
<p><strong>A:</strong>dim() will return NULL when applied to a 1d
vector.</p>
<p><strong>Q2:</strong>If is.matrix(x) is TRUE, what will is.array(x)
return?</p>
<p><strong>A:</strong>is.array(x) will return TRUE because a matrix is
also a two-dimensional array.</p>
</div>
<div id="section-2" class="section level2">
<h2>2.4.5</h2>
<p><strong>Q1:</strong>What attributes does a data frame possess?</p>
<p><strong>A:</strong>Names, row.names and class.</p>
<p><strong>Q2:</strong>What does as.matrix() do when applied to a data
frame with columns of different types?</p>
<p><strong>A:</strong>From help documents of as.matrix(): The method for
data frames will return a character matrix if there is only atomic
columns and any non-(numeric/logical/complex) column, applying as.vector
to factors and format to other non-character columns. Otherwise, the
usual coercion hierarchy (logical &lt; integer &lt; double &lt; complex)
will be used.</p>
<p><strong>Q3:</strong>Can you have a data frame with 0 rows? What about
0 columns?</p>
<p><strong>A:</strong>Yes, here is an example:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="fu">c</span>())</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(x);<span class="fu">ncol</span>(x)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<pre><code>## [1] 0</code></pre>
</div>
<div id="hw10" class="section level2">
<h2>HW10</h2>
</div>
<div id="exercise-11.1.2" class="section level2">
<h2>Exercise 11.1.2</h2>
<p>lapply() can be used to apply the function to every colume of a data
frame. This function needs a numeric input, so if the colume isn’t
numeric, we can return it directly.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>  (x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">data.frame</span>(<span class="fu">lapply</span>(iris,<span class="cf">function</span>(x) <span class="cf">if</span>(<span class="fu">is.numeric</span>(x)) <span class="fu">scale01</span>(x) <span class="cf">else</span> x)))</span></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1   0.22222222   0.6250000   0.06779661  0.04166667  setosa
## 2   0.16666667   0.4166667   0.06779661  0.04166667  setosa
## 3   0.11111111   0.5000000   0.05084746  0.04166667  setosa
## 4   0.08333333   0.4583333   0.08474576  0.04166667  setosa
## 5   0.19444444   0.6666667   0.06779661  0.04166667  setosa
## 6   0.30555556   0.7916667   0.11864407  0.12500000  setosa</code></pre>
<p>If we only want to apply the function to numeric columes, we can use
sapply() first to extract the numeric columes.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">data.frame</span>(<span class="fu">lapply</span>(iris[<span class="fu">sapply</span>(iris,is.numeric)],scale01)))</span></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width
## 1   0.22222222   0.6250000   0.06779661  0.04166667
## 2   0.16666667   0.4166667   0.06779661  0.04166667
## 3   0.11111111   0.5000000   0.05084746  0.04166667
## 4   0.08333333   0.4583333   0.08474576  0.04166667
## 5   0.19444444   0.6666667   0.06779661  0.04166667
## 6   0.30555556   0.7916667   0.11864407  0.12500000</code></pre>
</div>
<div id="exercise-11.2.5" class="section level2">
<h2>Exercise 11.2.5</h2>
<p>For a numeric data frame:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(cars, sd, <span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##     speed      dist 
##  5.287644 25.769377</code></pre>
<p>For a mixed data frame:</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(iris[<span class="fu">vapply</span>(iris, is.numeric, <span class="fu">logical</span>(<span class="dv">1</span>))],</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>       sd, </span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
##    0.8280661    0.4358663    1.7652982    0.7622377</code></pre>
</div>
<div id="exercise-3" class="section level2">
<h2>Exercise 3</h2>
<p><strong>Problem</strong></p>
<p>Implement a Gibbs sampler to generate a bivariate normal chain (Xt,
Yt) with zero means, unit standard deviations, and correlation 0.9.</p>
<p>• Write an Rcpp function.</p>
<p>• Compare the corresponding generated random numbers with pure R
language using the function “qqplot”.</p>
<p>• Compare the computation time of the two functions with the function
“microbenchmark”.</p>
<p><strong>Answer</strong></p>
<p>For a bivariate normal chain <span class="math inline">\((X_t,Y_t)\)</span>, we have <span class="math inline">\(\mu_1=\mu_2=0,\ \sigma_1=\sigma_2=1,\
\rho=0.9\)</span>. The conditional densities of a bivariate normal
distribution are univariate normal with parameters <span class="math display">\[E[Y|x]=\mu_1+\rho\frac{\sigma_2}{\sigma_1}(x-\mu_1)=0.9x,\
Var(Y|x)=(1-\rho^2)\sigma_2^2=0.19,\]</span> <span class="math display">\[E[X|y]=\mu_2+\rho\frac{\sigma_1}{\sigma_2}(y-\mu_2)=0.9y,\
Var(X|y)=(1-\rho^2)\sigma_1^2=0.19.\]</span></p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>GibbsR <span class="ot">&lt;-</span> <span class="cf">function</span>(N,<span class="at">mu1=</span><span class="dv">0</span>,<span class="at">mu2=</span><span class="dv">0</span>,<span class="at">sigma1=</span><span class="dv">1</span>,<span class="at">sigma2=</span><span class="dv">1</span>,<span class="at">rho=</span><span class="fl">0.9</span>){</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>  x0 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>  s1 <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma1</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>  s2 <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma2</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>,] <span class="ot">=</span> x0</span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>    y1 <span class="ot">=</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>    m1 <span class="ot">=</span> mu1 <span class="sc">+</span> rho <span class="sc">*</span> (y1 <span class="sc">-</span> mu2) <span class="sc">*</span> sigma1<span class="sc">/</span>sigma2</span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>    X[i, <span class="dv">1</span>] <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m1, s1)</span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">=</span> X[i, <span class="dv">1</span>]</span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a>    m2 <span class="ot">=</span> mu2 <span class="sc">+</span> rho <span class="sc">*</span> (x1 <span class="sc">-</span> mu1) <span class="sc">*</span> sigma2<span class="sc">/</span>sigma1</span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a>    X[i, <span class="dv">2</span>] <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m2, s2)</span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb111-15"><a href="#cb111-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(X)</span>
<span id="cb111-16"><a href="#cb111-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span></code></pre></div>
<pre><code>## Warning: package &#39;microbenchmark&#39; was built under R version 4.2.2</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co">#sourceCpp(&#39;GibbsC.cpp&#39;)</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">5000</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>gc <span class="ot">=</span> <span class="fu">GibbsC</span>(N)</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>gr <span class="ot">=</span> <span class="fu">GibbsR</span>(N)</span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(gc[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N,<span class="dv">1</span>], gr[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N,<span class="dv">1</span>],<span class="at">xlab=</span><span class="fu">bquote</span>(X[C]),<span class="at">ylab=</span><span class="fu">bquote</span>(X[R]))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(gc[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N,<span class="dv">2</span>], gr[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N,<span class="dv">2</span>],<span class="at">xlab=</span><span class="fu">bquote</span>(Y[C]),<span class="at">ylab=</span><span class="fu">bquote</span>(Y[R]))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">gibbR=</span><span class="fu">GibbsR</span>(N),</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="at">gibbC=</span><span class="fu">GibbsC</span>(N))</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##    expr       lq    median        uq
## 1 gibbR 9561.102 10323.701 15015.250
## 2 gibbC 1052.052  1082.202  1148.501</code></pre>
<p>From the results, the computation time of Rcpp function is much more
shorter than pure R function. The generated random numbers by two
functions are roughly on the line <span class="math inline">\(y=x\)</span>.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
